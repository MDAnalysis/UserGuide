


  
    
  




<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css" integrity="sha512-b1ASx0WHgVFL5ZQhTgiPWX+68KjS38Jk87jg7pe+qC7q9YkEtFq0z7xCglv7qGIs/68d3mAp+StfC8WKC5SSAg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="shortcut icon" href="../_static/logo/mda_favicon.ico">
</head>

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Auxiliary files &mdash; MDAnalysis User Guide  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/site.css" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />

  
    <link rel="canonical" href="https://userguide.mdanalysis.org/formats/auxiliary.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="../_static/js/versions.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis User Guide  documentation"
          href="../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Selection exporters" href="selection_exporters.html" />
    <link rel="prev" title="Guessing" href="guessing.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >




  




<a href="../index.html">
  
    <img src="../_static/user_guide.png" class="logo" alt="Logo"/>
</a>


  
  
  
    <div class="version">
      2.8.0-dev0
    </div>
  



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div>
<div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
    <!-- <p class="caption" role="heading"></p> -->
    <ul>
        
        <li class="toctree-l1"><a class="reference internal" href="https://mdanalysis.org">MDAnalysis</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="https://docs.mdanalysis.org/stable">API docs (stable)</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="https://docs.mdanalysis.org/dev">API docs (development)</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="https://mdakits.mdanalysis.org/">MDAKits</a></li>
        
    </ul>
    
        <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/quickstart.html">Quick start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/README.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">MDAnalysis Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data structures</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../universe.html">Universe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../atomgroup.html">AtomGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../groups_of_atoms.html">Groups of atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections.html">Atom selection language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology_system.html">The topology system</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Trajectories</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../trajectories/trajectories.html">Trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectories/slicing_trajectories.html">Slicing trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectories/transformations.html">On-the-fly transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">Units and constants</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Input/output</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../reading_and_writing.html">Reading and writing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Format overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="guessing.html">Guessing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Auxiliary files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#supported-formats">Supported formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="#xvg-files">XVG Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-data-directly">Reading data directly</a></li>
<li class="toctree-l2"><a class="reference internal" href="#loading-data-into-a-universe">Loading data into a Universe</a></li>
<li class="toctree-l2"><a class="reference internal" href="#passing-arguments-to-auxiliary-data">Passing arguments to auxiliary data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#iterating-over-auxiliary-data">Iterating over auxiliary data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-auxiliary-attributes">Accessing auxiliary attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#recreating-auxiliaries">Recreating auxiliaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="#edr-files">EDR Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#standalone-usage">Standalone Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#unit-handling">Unit Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#use-with-trajectories">Use with Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="#selecting-trajectory-frames-based-on-auxiliary-data">Selecting Trajectory Frames Based on Auxiliary Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#memory-usage">Memory Usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="selection_exporters.html">Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="format_reference.html">Format reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/analysis/README.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/analysis/README.html#alignments-and-rms-fitting">Alignments and RMS fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/analysis/README.html#distances-and-contacts">Distances and contacts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/analysis/README.html#trajectory-similarity">Trajectory similarity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/analysis/README.html#structure">Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/analysis/README.html#volumetric-analyses">Volumetric analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/analysis/README.html#dimension-reduction">Dimension reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/analysis/README.html#polymers-and-membranes">Polymers and membranes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/analysis/README.html#hydrogen-bond-analysis">Hydrogen Bond Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/analysis/custom_trajectory_analysis.html">Writing your own trajectory analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/analysis/custom_parallel_analysis.html">Parallelizing analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../standard_selections.html">Standard residues in MDAnalysis selections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_topology.html">Advanced topology concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datasets.html">Example data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing_code.html">Contributing to the main codebase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing_docs.html">Contributing to the user guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preparing_releases_and_hotfixes.html">Preparing a release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module_imports.html">Module imports in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing.html">Tests in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

</div>

      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MDAnalysis User Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Auxiliary files</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/formats/auxiliary.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="auxiliary-files">
<span id="auxiliary"></span><h1>Auxiliary files<a class="headerlink" href="#auxiliary-files" title="Link to this heading"></a></h1>
<p>Auxiliary readers allow you to read in timeseries data accompanying a trajectory that is not stored in the regular trajectory file.</p>
<section id="supported-formats">
<h2>Supported formats<a class="headerlink" href="#supported-formats" title="Link to this heading"></a></h2>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Reader</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Extension
(if file)</p></th>
<th class="head"><p>Remarks</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-class docutils literal notranslate"><span class="pre">XVGReader</span></code></p></td>
<td><p>XVG</p></td>
<td><p>xvg</p>
<p>(default)</p>
</td>
<td><p>Produced by Gromacs during simulation
or analysis.
Reads full file on initialisation.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-class docutils literal notranslate"><span class="pre">XVGFileReader</span></code></p></td>
<td><p>XVG-F</p></td>
<td><p>xvg</p></td>
<td><p>Alternate xvg file reader, reading
each step from the file in turn for a
lower memory footprint.
<code class="xref py py-class docutils literal notranslate"><span class="pre">XVGReader</span></code> is the default
reader for .xvg files.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-class docutils literal notranslate"><span class="pre">EDRReader</span></code></p></td>
<td><p>EDR</p></td>
<td><p>edr</p></td>
<td><p>Produced by Gromacs during simulation
or analysis.
Reads full file on initialisation.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="xvg-files">
<h2>XVG Files<a class="headerlink" href="#xvg-files" title="Link to this heading"></a></h2>
</section>
<section id="reading-data-directly">
<h2>Reading data directly<a class="headerlink" href="#reading-data-directly" title="Link to this heading"></a></h2>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>

<span class="gp">In [2]: </span><span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">XVG_BZ2</span>  <span class="c1"># cobrotoxin protein forces</span>

<span class="gp">In [3]: </span><span class="n">aux</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">auxiliary</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">auxreader</span><span class="p">(</span><span class="n">XVG_BZ2</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">aux</span>
<span class="gh">Out[4]: </span><span class="go">&lt;MDAnalysis.auxiliary.XVG.XVGReader at 0x7fa0d6d10160&gt;</span>
</pre></div>
</div>
<p>In stand-alone use, an auxiliary reader allows you to iterate over each step in a set of auxiliary data.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">aux</span><span class="p">:</span>
<span class="gp">   ...: </span>    <span class="nb">print</span><span class="p">(</span><span class="n">step</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="gp">   ...: </span>
<span class="go">[    0.        200.71288 -1552.2849  ...   128.4072   1386.0378</span>
<span class="go"> -2699.3118 ]</span>
<span class="go">[   50.      -1082.6454   -658.32166 ...  -493.02954   589.8844</span>
<span class="go">  -739.2124 ]</span>
<span class="go">[  100.       -246.27269   146.52911 ...   484.32501  2332.3767</span>
<span class="go"> -1801.6234 ]</span>
</pre></div>
</div>
<p>Use slicing to skip steps.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">aux</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]:</span>
<span class="gp">   ...: </span>    <span class="nb">print</span><span class="p">(</span><span class="n">step</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="gp">   ...: </span>
<span class="go">50.0</span>
</pre></div>
</div>
<p>The <a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/auxiliary/core.html#MDAnalysis.auxiliary.core.auxreader" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">auxreader()</span></code></a> function uses the <a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/auxiliary/core.html#MDAnalysis.auxiliary.core.get_auxreader_for" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_auxreader_for()</span></code></a> to return an appropriate class. This can guess the format either from a filename, ‘</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">mda</span><span class="o">.</span><span class="n">auxiliary</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">get_auxreader_for</span><span class="p">(</span><span class="n">XVG_BZ2</span><span class="p">)</span>
<span class="gh">Out[7]: </span><span class="go">MDAnalysis.auxiliary.XVG.XVGReader</span>
</pre></div>
</div>
<p>or return the reader for a specified format.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">mda</span><span class="o">.</span><span class="n">auxiliary</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">get_auxreader_for</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;XVG-F&#39;</span><span class="p">)</span>
<span class="gh">Out[8]: </span><span class="go">MDAnalysis.auxiliary.XVG.XVGFileReader</span>
</pre></div>
</div>
</section>
<section id="loading-data-into-a-universe">
<h2>Loading data into a Universe<a class="headerlink" href="#loading-data-into-a-universe" title="Link to this heading"></a></h2>
<p>Auxiliary data may be added to a trajectory Reader through the
<a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.add_auxiliary" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_auxiliary()</span></code></a> method. Auxiliary data
may be passed in as a AuxReader instance, or directly as e.g. a filename, in
which case <a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/auxiliary/core.html#MDAnalysis.auxiliary.core.get_auxreader_for" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_auxreader_for()</span></code></a> is used to
guess an appropriate reader.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">PDB_xvf</span><span class="p">,</span> <span class="n">TRR_xvf</span>

<span class="gp">In [10]: </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PDB_xvf</span><span class="p">,</span> <span class="n">TRR_xvf</span><span class="p">)</span>

<span class="gp">In [11]: </span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">add_auxiliary</span><span class="p">(</span><span class="s1">&#39;protein_force&#39;</span><span class="p">,</span> <span class="n">XVG_BZ2</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">:</span>
<span class="gp">   ....: </span>    <span class="nb">print</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">aux</span><span class="o">.</span><span class="n">protein_force</span><span class="p">)</span>
<span class="gp">   ....: </span>
<span class="go">[    0.        200.71288 -1552.2849  ...   128.4072   1386.0378</span>
<span class="go"> -2699.3118 ]</span>
<span class="go">[   50.      -1082.6454   -658.32166 ...  -493.02954   589.8844</span>
<span class="go">  -739.2124 ]</span>
<span class="go">[  100.       -246.27269   146.52911 ...   484.32501  2332.3767</span>
<span class="go"> -1801.6234 ]</span>
</pre></div>
</div>
</section>
<section id="passing-arguments-to-auxiliary-data">
<h2>Passing arguments to auxiliary data<a class="headerlink" href="#passing-arguments-to-auxiliary-data" title="Link to this heading"></a></h2>
<p>For alignment with trajectory data, auxiliary readers provide methods to
assign each auxiliary step to the nearest trajectory timestep, read all steps
assigned to a trajectory timestep and calculate ‘representative’ value(s) of
the auxiliary data for that timestep.</p>
<p>To set a timestep or ??</p>
<p>‘Assignment’ of auxiliary steps to trajectory timesteps is determined from the time
of the auxiliary step, <code class="docutils literal notranslate"><span class="pre">dt</span></code> of the trajectory and time at the first frame of the
trajectory. If there are no auxiliary steps assigned to a given timestep (or none within
<code class="docutils literal notranslate"><span class="pre">cutoff</span></code>, if set), the representative value(s) are set to <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>.</p>
</section>
<section id="iterating-over-auxiliary-data">
<h2>Iterating over auxiliary data<a class="headerlink" href="#iterating-over-auxiliary-data" title="Link to this heading"></a></h2>
<p>Auxiliary data may not perfectly line up with the trajectory, or have missing data.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [13]: </span><span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">PDB</span><span class="p">,</span> <span class="n">TRR</span>

<span class="gp">In [14]: </span><span class="n">u_long</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PDB</span><span class="p">,</span> <span class="n">TRR</span><span class="p">)</span>

<span class="gp">In [15]: </span><span class="n">u_long</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">add_auxiliary</span><span class="p">(</span><span class="s1">&#39;protein_force&#39;</span><span class="p">,</span> <span class="n">XVG_BZ2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

<span class="gp">In [16]: </span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u_long</span><span class="o">.</span><span class="n">trajectory</span><span class="p">:</span>
<span class="gp">   ....: </span>    <span class="nb">print</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">aux</span><span class="o">.</span><span class="n">protein_force</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">   ....: </span>
<span class="go">0.0 [    0.        200.71288 -1552.2849   -967.21124]</span>
<span class="go">100.00000762939453 [  100.       -246.27269   146.52911 -1084.2484 ]</span>
<span class="go">200.00001525878906 [nan nan nan nan]</span>
<span class="go">300.0 [nan nan nan nan]</span>
<span class="go">400.0000305175781 [nan nan nan nan]</span>
<span class="go">500.0000305175781 [nan nan nan nan]</span>
<span class="go">600.0 [nan nan nan nan]</span>
<span class="go">700.0000610351562 [nan nan nan nan]</span>
<span class="go">800.0000610351562 [nan nan nan nan]</span>
<span class="go">900.0000610351562 [nan nan nan nan]</span>
</pre></div>
</div>
<p>The trajectory <a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProtoReader</span></code></a> methods
<a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.next_as_aux" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">next_as_aux()</span></code></a> and
<a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.iter_as_aux" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">iter_as_aux()</span></code></a> allow for movement
through only trajectory timesteps for which auxiliary data is available.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u_long</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">iter_as_aux</span><span class="p">(</span><span class="s1">&#39;protein_force&#39;</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="nb">print</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">aux</span><span class="o">.</span><span class="n">protein_force</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">   ....: </span>
<span class="go">0.0 [    0.        200.71288 -1552.2849   -967.21124]</span>
<span class="go">100.00000762939453 [  100.       -246.27269   146.52911 -1084.2484 ]</span>
</pre></div>
</div>
<p>This may be used to
avoid representative values set to <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>, particularly when auxiliary data
is less frequent.</p>
<p>Sometimes the auxiliary data is longer than the trajectory.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="n">u_short</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PDB</span><span class="p">)</span>

<span class="gp">In [19]: </span><span class="n">u_short</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">add_auxiliary</span><span class="p">(</span><span class="s1">&#39;protein_force&#39;</span><span class="p">,</span> <span class="n">XVG_BZ2</span><span class="p">)</span>

<span class="gp">In [20]: </span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u_short</span><span class="o">.</span><span class="n">trajectory</span><span class="p">:</span>
<span class="gp">   ....: </span>    <span class="nb">print</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">aux</span><span class="o">.</span><span class="n">protein_force</span><span class="p">)</span>
<span class="gp">   ....: </span>
<span class="go">0.0 [    0.        200.71288 -1552.2849  ...   128.4072   1386.0378</span>
<span class="go"> -2699.3118 ]</span>
</pre></div>
</div>
<p>In order to acess auxiliary values at every individual step, including those
outside the time range of the trajectory,
<a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.iter_auxiliary" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">iter_auxiliary()</span></code></a> allows iteration
over the auxiliary independent of the trajectory.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [21]: </span><span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">u_short</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">iter_auxiliary</span><span class="p">(</span><span class="s1">&#39;protein_force&#39;</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="nb">print</span><span class="p">(</span><span class="n">step</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="gp">   ....: </span>
<span class="go">[    0.        200.71288 -1552.2849  ...   128.4072   1386.0378</span>
<span class="go"> -2699.3118 ]</span>
<span class="go">[   50.      -1082.6454   -658.32166 ...  -493.02954   589.8844</span>
<span class="go">  -739.2124 ]</span>
<span class="go">[  100.       -246.27269   146.52911 ...   484.32501  2332.3767</span>
<span class="go"> -1801.6234 ]</span>
</pre></div>
</div>
<p>To iterate over only a certain section of the auxiliary:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [22]: </span><span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">u_short</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">iter_auxiliary</span><span class="p">(</span><span class="s1">&#39;protein_force&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="nb">print</span><span class="p">(</span><span class="n">step</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="gp">   ....: </span>
<span class="go">50.0</span>
</pre></div>
</div>
<p>The trajectory remains unchanged, and the auxiliary will be returned to the current
timestep after iteration is complete.</p>
</section>
<section id="accessing-auxiliary-attributes">
<h2>Accessing auxiliary attributes<a class="headerlink" href="#accessing-auxiliary-attributes" title="Link to this heading"></a></h2>
<p>To check the values of attributes of an added auxiliary, use
<a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.get_aux_attribute" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_aux_attribute()</span></code></a>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [23]: </span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">get_aux_attribute</span><span class="p">(</span><span class="s1">&#39;protein_force&#39;</span><span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">)</span>
<span class="gh">Out[23]: </span><span class="go">50.0</span>
</pre></div>
</div>
<p>If attributes are settable, they can be changed using
<a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.set_aux_attribute" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_aux_attribute()</span></code></a>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [24]: </span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">set_aux_attribute</span><span class="p">(</span><span class="s1">&#39;protein_force&#39;</span><span class="p">,</span> <span class="s1">&#39;data_selector&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>The auxiliary may be renamed using <code class="docutils literal notranslate"><span class="pre">set_aux_attribute</span></code> with ‘auxname’, or more
directly by using <a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.rename_aux" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rename_aux()</span></code></a>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [25]: </span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">aux</span><span class="o">.</span><span class="n">protein_force</span>
<span class="gh">Out[25]: </span>
<span class="go">array([    0.     ,   200.71288, -1552.2849 , ...,   128.4072 ,</span>
<span class="go">        1386.0378 , -2699.3118 ])</span>

<span class="gp">In [26]: </span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">rename_aux</span><span class="p">(</span><span class="s1">&#39;protein_force&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>

<span class="gp">In [27]: </span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">aux</span><span class="o">.</span><span class="n">f</span>
<span class="gh">Out[27]: </span>
<span class="go">array([    0.     ,   200.71288, -1552.2849 , ...,   128.4072 ,</span>
<span class="go">        1386.0378 , -2699.3118 ])</span>
</pre></div>
</div>
</section>
<section id="recreating-auxiliaries">
<h2>Recreating auxiliaries<a class="headerlink" href="#recreating-auxiliaries" title="Link to this heading"></a></h2>
<p>To recreate an auxiliary, the set of attributes necessary to replicate it can
first be obtained with <a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/auxiliary/base.html#MDAnalysis.auxiliary.base.AuxReader.get_description" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_description()</span></code></a>.
The returned dictionary can then be passed to
<a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/auxiliary/core.html#MDAnalysis.auxiliary.core.auxreader" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">auxreader()</span></code></a> to load a new copy of the
original auxiliary reader.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [28]: </span><span class="n">description</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">get_description</span><span class="p">()</span>

<span class="gp">In [29]: </span><span class="nb">list</span><span class="p">(</span><span class="n">description</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="gh">Out[29]: </span>
<span class="go">[&#39;represent_ts_as&#39;,</span>
<span class="go"> &#39;cutoff&#39;,</span>
<span class="go"> &#39;dt&#39;,</span>
<span class="go"> &#39;initial_time&#39;,</span>
<span class="go"> &#39;time_selector&#39;,</span>
<span class="go"> &#39;data_selector&#39;,</span>
<span class="go"> &#39;constant_dt&#39;,</span>
<span class="go"> &#39;auxname&#39;,</span>
<span class="go"> &#39;format&#39;,</span>
<span class="go"> &#39;auxdata&#39;]</span>

<span class="gp">In [30]: </span><span class="k">del</span> <span class="n">aux</span>

<span class="gp">In [31]: </span><span class="n">mda</span><span class="o">.</span><span class="n">auxiliary</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">auxreader</span><span class="p">(</span><span class="o">**</span><span class="n">description</span><span class="p">)</span>
<span class="gh">Out[31]: </span><span class="go">&lt;MDAnalysis.auxiliary.XVG.XVGReader at 0x7fa0d6f7ba90&gt;</span>
</pre></div>
</div>
<p>The ‘description’ of any or all the auxiliaries added to a trajectory can be
obtained using <a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.get_aux_descriptions" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_aux_descriptions()</span></code></a>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [32]: </span><span class="n">descriptions</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">get_aux_descriptions</span><span class="p">([</span><span class="s1">&#39;f&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>To reload, pass the dictionary into <a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.add_auxiliary" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_auxiliary()</span></code></a>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [33]: </span><span class="n">u2</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PDB</span><span class="p">,</span> <span class="n">TRR</span><span class="p">)</span>

<span class="gp">In [34]: </span><span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">descriptions</span><span class="p">:</span>
<span class="gp">   ....: </span>     <span class="n">u2</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">add_auxiliary</span><span class="p">(</span><span class="o">**</span><span class="n">desc</span><span class="p">)</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
</section>
<section id="edr-files">
<h2>EDR Files<a class="headerlink" href="#edr-files" title="Link to this heading"></a></h2>
<p>EDR files are created by GROMACS during simulations and contain additional non-trajectory time-series data of the
system, such as energies, temperature, or pressure. The EDRReader allows direct reading of these binary files
and associating of the data with trajectory time steps just like the XVGReader does. As all functionality of the base AuxReaders (see XVGReader above) also works with
the EDRReader, this section will highlight functionality unique to the EDRReader.</p>
</section>
<section id="standalone-usage">
<h2>Standalone Usage<a class="headerlink" href="#standalone-usage" title="Link to this heading"></a></h2>
<p>The EDRReader is initialised by passing the path to an EDR file as an argument.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [35]: </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>

<span class="gp">In [36]: </span><span class="kn">from</span> <span class="nn">MDAnalysisTests.datafiles</span> <span class="kn">import</span> <span class="n">AUX_EDR</span>

<span class="gp">In [37]: </span><span class="n">aux</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">auxiliary</span><span class="o">.</span><span class="n">EDR</span><span class="o">.</span><span class="n">EDRReader</span><span class="p">(</span><span class="n">AUX_EDR</span><span class="p">)</span>

<span class="go"> # Or, for example</span>
<span class="go"> # aux = mda.auxiliary.EDR.EDRReader(&quot;path/to/file/ener.edr&quot;)</span>
</pre></div>
</div>
<p>Dozens of terms can be defined in EDR files. A list of available data is conveniently available unter the <cite>terms</cite> attribute.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [38]: </span><span class="n">aux</span><span class="o">.</span><span class="n">terms</span>
<span class="gh">Out[38]: </span>
<span class="go">[&#39;Time&#39;,</span>
<span class="go"> &#39;Bond&#39;,</span>
<span class="go"> &#39;Angle&#39;,</span>
<span class="go"> &#39;Proper Dih.&#39;,</span>
<span class="go"> &#39;Ryckaert-Bell.&#39;,</span>
<span class="go"> &#39;LJ-14&#39;,</span>
<span class="go"> &#39;Coulomb-14&#39;,</span>
<span class="go"> &#39;LJ (SR)&#39;,</span>
<span class="go"> &#39;Disper. corr.&#39;,</span>
<span class="go"> &#39;Coulomb (SR)&#39;,</span>
<span class="go"> &#39;Coul. recip.&#39;,</span>
<span class="go"> &#39;Potential&#39;,</span>
<span class="go"> &#39;Kinetic En.&#39;,</span>
<span class="go"> &#39;Total Energy&#39;,</span>
<span class="go"> &#39;Conserved En.&#39;,</span>
<span class="go"> &#39;Temperature&#39;,</span>
<span class="go"> &#39;Pres. DC&#39;,</span>
<span class="go"> &#39;Pressure&#39;,</span>
<span class="go"> &#39;Constr. rmsd&#39;,</span>
<span class="go"> &#39;Box-X&#39;,</span>
<span class="go"> &#39;Box-Y&#39;,</span>
<span class="go"> &#39;Box-Z&#39;,</span>
<span class="go"> &#39;Volume&#39;,</span>
<span class="go"> &#39;Density&#39;,</span>
<span class="go"> &#39;pV&#39;,</span>
<span class="go"> &#39;Enthalpy&#39;,</span>
<span class="go"> &#39;Vir-XX&#39;,</span>
<span class="go"> &#39;Vir-XY&#39;,</span>
<span class="go"> &#39;Vir-XZ&#39;,</span>
<span class="go"> &#39;Vir-YX&#39;,</span>
<span class="go"> &#39;Vir-YY&#39;,</span>
<span class="go"> &#39;Vir-YZ&#39;,</span>
<span class="go"> &#39;Vir-ZX&#39;,</span>
<span class="go"> &#39;Vir-ZY&#39;,</span>
<span class="go"> &#39;Vir-ZZ&#39;,</span>
<span class="go"> &#39;Pres-XX&#39;,</span>
<span class="go"> &#39;Pres-XY&#39;,</span>
<span class="go"> &#39;Pres-XZ&#39;,</span>
<span class="go"> &#39;Pres-YX&#39;,</span>
<span class="go"> &#39;Pres-YY&#39;,</span>
<span class="go"> &#39;Pres-YZ&#39;,</span>
<span class="go"> &#39;Pres-ZX&#39;,</span>
<span class="go"> &#39;Pres-ZY&#39;,</span>
<span class="go"> &#39;Pres-ZZ&#39;,</span>
<span class="go"> &#39;#Surf*SurfTen&#39;,</span>
<span class="go"> &#39;Box-Vel-XX&#39;,</span>
<span class="go"> &#39;Box-Vel-YY&#39;,</span>
<span class="go"> &#39;Box-Vel-ZZ&#39;,</span>
<span class="go"> &#39;T-Protein&#39;,</span>
<span class="go"> &#39;T-non-Protein&#39;,</span>
<span class="go"> &#39;Lamb-Protein&#39;,</span>
<span class="go"> &#39;Lamb-non-Protein&#39;]</span>
</pre></div>
</div>
<p>To extract data for plotting, the <cite>get_data</cite> method can be used. It can be used to extract a single, multiple, or all terms as follows:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [39]: </span><span class="n">temp</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Temperature&quot;</span><span class="p">)</span>

<span class="gp">In [40]: </span><span class="nb">print</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="go">dict_keys([&#39;Time&#39;, &#39;Temperature&#39;])</span>

<span class="gp">In [41]: </span><span class="n">energies</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">get_data</span><span class="p">([</span><span class="s2">&quot;Potential&quot;</span><span class="p">,</span> <span class="s2">&quot;Kinetic En.&quot;</span><span class="p">])</span>

<span class="gp">In [42]: </span><span class="nb">print</span><span class="p">(</span><span class="n">energies</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="go">dict_keys([&#39;Time&#39;, &#39;Potential&#39;, &#39;Kinetic En.&#39;])</span>

<span class="gp">In [43]: </span><span class="n">all_data</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

<span class="gp">In [44]: </span><span class="nb">print</span><span class="p">(</span><span class="n">all_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="go">dict_keys([&#39;Time&#39;, &#39;Bond&#39;, &#39;Angle&#39;, &#39;Proper Dih.&#39;, &#39;Ryckaert-Bell.&#39;, &#39;LJ-14&#39;, &#39;Coulomb-14&#39;, &#39;LJ (SR)&#39;, &#39;Disper. corr.&#39;, &#39;Coulomb (SR)&#39;, &#39;Coul. recip.&#39;, &#39;Potential&#39;, &#39;Kinetic En.&#39;, &#39;Total Energy&#39;, &#39;Conserved En.&#39;, &#39;Temperature&#39;, &#39;Pres. DC&#39;, &#39;Pressure&#39;, &#39;Constr. rmsd&#39;, &#39;Box-X&#39;, &#39;Box-Y&#39;, &#39;Box-Z&#39;, &#39;Volume&#39;, &#39;Density&#39;, &#39;pV&#39;, &#39;Enthalpy&#39;, &#39;Vir-XX&#39;, &#39;Vir-XY&#39;, &#39;Vir-XZ&#39;, &#39;Vir-YX&#39;, &#39;Vir-YY&#39;, &#39;Vir-YZ&#39;, &#39;Vir-ZX&#39;, &#39;Vir-ZY&#39;, &#39;Vir-ZZ&#39;, &#39;Pres-XX&#39;, &#39;Pres-XY&#39;, &#39;Pres-XZ&#39;, &#39;Pres-YX&#39;, &#39;Pres-YY&#39;, &#39;Pres-YZ&#39;, &#39;Pres-ZX&#39;, &#39;Pres-ZY&#39;, &#39;Pres-ZZ&#39;, &#39;#Surf*SurfTen&#39;, &#39;Box-Vel-XX&#39;, &#39;Box-Vel-YY&#39;, &#39;Box-Vel-ZZ&#39;, &#39;T-Protein&#39;, &#39;T-non-Protein&#39;, &#39;Lamb-Protein&#39;, &#39;Lamb-non-Protein&#39;])</span>
</pre></div>
</div>
<p>The times of each data point are always part of the returned dictionary to facilicate plotting.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [45]: </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="gp">In [46]: </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">],</span> <span class="n">temp</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">])</span>
<span class="gh">Out[46]: </span><span class="go">[&lt;matplotlib.lines.Line2D at 0x7fa0d6e57700&gt;]</span>

<span class="gp">In [47]: </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Temperature [K]&quot;</span><span class="p">)</span>
<span class="gh">Out[47]: </span><span class="go">Text(0, 0.5, &#39;Temperature [K]&#39;)</span>

<span class="gp">In [48]: </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time [ps]&quot;</span><span class="p">)</span>
<span class="gh">Out[48]: </span><span class="go">Text(0.5, 0, &#39;Time [ps]&#39;)</span>

<span class="gp">In [49]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/79835177181377e2588d274aed9cad44/auxiliary-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/e26175fa4b43d8229a32471a3e7c7831/auxiliary-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/35d4323e5cc041e33705e58839d7a259/auxiliary-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/899668c9e2e17d4c2fc64131d19cdebc/auxiliary-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/auxiliary-1.png" class="plot-directive" src="../_images/auxiliary-1.png" />
</figure>
</section>
<section id="unit-handling">
<h2>Unit Handling<a class="headerlink" href="#unit-handling" title="Link to this heading"></a></h2>
<p>On object creation, the EDRReader creates a <code class="docutils literal notranslate"><span class="pre">unit_dict</span></code> attribute which contains
information on the units of the data stored within. These units are read from the
EDR file automatically and by default converted to MDAnalysis base units where such units
are defined. The automatic unit conversion can be disabled by setting the <code class="docutils literal notranslate"><span class="pre">convert_units</span></code> kwarg to False.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [50]: </span><span class="n">aux</span><span class="o">.</span><span class="n">unit_dict</span><span class="p">[</span><span class="s2">&quot;Box-X&quot;</span><span class="p">]</span>
<span class="gh">Out[50]: </span><span class="go">&#39;A&#39;</span>

<span class="gp">In [51]: </span><span class="n">aux_native</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">auxiliary</span><span class="o">.</span><span class="n">EDR</span><span class="o">.</span><span class="n">EDRReader</span><span class="p">(</span><span class="n">AUX_EDR</span><span class="p">,</span> <span class="n">convert_units</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="gp">In [52]: </span><span class="n">aux_native</span><span class="o">.</span><span class="n">unit_dict</span><span class="p">[</span><span class="s2">&quot;Box-X&quot;</span><span class="p">]</span>
<span class="gh">Out[52]: </span><span class="go">&#39;nm&#39;</span>
</pre></div>
</div>
</section>
<section id="use-with-trajectories">
<h2>Use with Trajectories<a class="headerlink" href="#use-with-trajectories" title="Link to this heading"></a></h2>
<p>An arbitrary number of terms to be associated with a trajectory can be specified as a dictionary.
The dictionary is chosen so that the name to be used in MDAnalysis to access the data is mapped to the name in <cite>aux.terms</cite>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [53]: </span><span class="kn">from</span> <span class="nn">MDAnalysisTests.datafiles</span> <span class="kn">import</span> <span class="n">AUX_EDR_TPR</span><span class="p">,</span> <span class="n">AUX_EDR_XTC</span>

<span class="gp">In [54]: </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">AUX_EDR_TPR</span><span class="p">,</span> <span class="n">AUX_EDR_XTC</span><span class="p">)</span>

<span class="gp">In [55]: </span><span class="n">term_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;temp&quot;</span><span class="p">:</span> <span class="s2">&quot;Temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;epot&quot;</span><span class="p">:</span> <span class="s2">&quot;Potential&quot;</span><span class="p">}</span>

<span class="gp">In [56]: </span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">add_auxiliary</span><span class="p">(</span><span class="n">term_dict</span><span class="p">,</span> <span class="n">aux</span><span class="p">)</span>

<span class="gp">In [57]: </span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">aux</span><span class="o">.</span><span class="n">epot</span>
<span class="gh">Out[57]: </span><span class="go">-525164.0625</span>
</pre></div>
</div>
<p>Adding all data is possible by omitting the dictionary as follows. It is then necessary to
specify that the EDRReader should be passed as the <cite>auxdata</cite> argument as such:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [58]: </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">AUX_EDR_TPR</span><span class="p">,</span> <span class="n">AUX_EDR_XTC</span><span class="p">)</span>

<span class="gp">In [59]: </span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">add_auxiliary</span><span class="p">(</span><span class="n">auxdata</span><span class="o">=</span><span class="n">aux</span><span class="p">)</span>

<span class="gp">In [60]: </span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">aux_list</span>
<span class="gh">Out[60]: </span><span class="go">dict_keys([&#39;Time&#39;, &#39;Bond&#39;, &#39;Angle&#39;, &#39;Proper Dih.&#39;, &#39;Ryckaert-Bell.&#39;, &#39;LJ-14&#39;, &#39;Coulomb-14&#39;, &#39;LJ (SR)&#39;, &#39;Disper. corr.&#39;, &#39;Coulomb (SR)&#39;, &#39;Coul. recip.&#39;, &#39;Potential&#39;, &#39;Kinetic En.&#39;, &#39;Total Energy&#39;, &#39;Conserved En.&#39;, &#39;Temperature&#39;, &#39;Pres. DC&#39;, &#39;Pressure&#39;, &#39;Constr. rmsd&#39;, &#39;Box-X&#39;, &#39;Box-Y&#39;, &#39;Box-Z&#39;, &#39;Volume&#39;, &#39;Density&#39;, &#39;pV&#39;, &#39;Enthalpy&#39;, &#39;Vir-XX&#39;, &#39;Vir-XY&#39;, &#39;Vir-XZ&#39;, &#39;Vir-YX&#39;, &#39;Vir-YY&#39;, &#39;Vir-YZ&#39;, &#39;Vir-ZX&#39;, &#39;Vir-ZY&#39;, &#39;Vir-ZZ&#39;, &#39;Pres-XX&#39;, &#39;Pres-XY&#39;, &#39;Pres-XZ&#39;, &#39;Pres-YX&#39;, &#39;Pres-YY&#39;, &#39;Pres-YZ&#39;, &#39;Pres-ZX&#39;, &#39;Pres-ZY&#39;, &#39;Pres-ZZ&#39;, &#39;#Surf*SurfTen&#39;, &#39;Box-Vel-XX&#39;, &#39;Box-Vel-YY&#39;, &#39;Box-Vel-ZZ&#39;, &#39;T-Protein&#39;, &#39;T-non-Protein&#39;, &#39;Lamb-Protein&#39;, &#39;Lamb-non-Protein&#39;])</span>
</pre></div>
</div>
</section>
<section id="selecting-trajectory-frames-based-on-auxiliary-data">
<h2>Selecting Trajectory Frames Based on Auxiliary Data<a class="headerlink" href="#selecting-trajectory-frames-based-on-auxiliary-data" title="Link to this heading"></a></h2>
<p>One use case for the new auxiliary readers is the selection of frames based on auxiliary data.
To select only those frames with a potential energy below a certain threshold, the
following can be used:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [61]: </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">AUX_EDR_TPR</span><span class="p">,</span> <span class="n">AUX_EDR_XTC</span><span class="p">)</span>

<span class="gp">In [62]: </span><span class="n">term_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;epot&quot;</span><span class="p">:</span> <span class="s2">&quot;Potential&quot;</span><span class="p">}</span>

<span class="gp">In [63]: </span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">add_auxiliary</span><span class="p">(</span><span class="n">term_dict</span><span class="p">,</span> <span class="n">aux</span><span class="p">)</span>

<span class="gp">In [64]: </span><span class="n">selected_frames</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ts</span><span class="o">.</span><span class="n">frame</span> <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span> <span class="k">if</span> <span class="n">ts</span><span class="o">.</span><span class="n">aux</span><span class="o">.</span><span class="n">epot</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">524600</span><span class="p">])</span>
</pre></div>
</div>
<p>A slice of the trajectory can then be obtained from the list of frames as such:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [65]: </span><span class="n">trajectory_slice</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="n">selected_frames</span><span class="p">]</span>

<span class="gp">In [66]: </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">))</span>
<span class="go">4</span>

<span class="gp">In [67]: </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trajectory_slice</span><span class="p">))</span>
<span class="go">2</span>
</pre></div>
</div>
</section>
<section id="memory-usage">
<h2>Memory Usage<a class="headerlink" href="#memory-usage" title="Link to this heading"></a></h2>
<p>It is assumed that the EDR file is small enough to be read in full. However,
since one EDRReader instance is created for each term added to a trajectory,
memory usage monitoring was implemented. A warning will be issued if 1 GB of
memory is used by auxiliary data. This warning limit can optionally be changed
by defining the <cite>memory_limit</cite> (in bytes) when adding data to a trajectory. Below,
the memory limit is set to 200 MB.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [68]: </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">AUX_EDR_TPR</span><span class="p">,</span> <span class="n">AUX_EDR_XTC</span><span class="p">)</span>

<span class="gp">In [69]: </span><span class="n">term_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;temp&quot;</span><span class="p">:</span> <span class="s2">&quot;Temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;epot&quot;</span><span class="p">:</span> <span class="s2">&quot;Potential&quot;</span><span class="p">}</span>

<span class="gp">In [70]: </span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">add_auxiliary</span><span class="p">(</span><span class="n">term_dict</span><span class="p">,</span> <span class="n">aux</span><span class="p">,</span> <span class="n">memory_limit</span><span class="o">=</span><span class="mf">2e+08</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="guessing.html" class="btn btn-neutral float-left" title="Guessing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="selection_exporters.html" class="btn btn-neutral float-right" title="Selection exporters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2024, Lily Wang, Irfan Alibay, Patricio Barletta, Cédric Bouysset, Jan Domanski, Bjarne Feddersen, Mike Henry, Florent Langenfeld, Hugo MacDermott-Opeskin, Micaela Matta, Rocco Meli, Mahfuza Humayra Mohona, Paul Smith, Mieczyslaw Torchala, Mark Verma, Yuxuan Zhuang, Richard J. Gowers, and Oliver Beckstein..</p>
  </div>

  

<div class="footer"><p>Please see
    our <a href="https://www.mdanalysis.org/pages/privacy/">Privacy Policy</a>
    to learn how <a href="https://www.mdanalysis.org">MDAnalysis</a> collects data.</p>
    <script data-goatcounter="https://mdanalysis.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
    var versions_json_url = 'https://userguide.mdanalysis.org/versions.json'
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>