


  
    
  




<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css" integrity="sha512-b1ASx0WHgVFL5ZQhTgiPWX+68KjS38Jk87jg7pe+qC7q9YkEtFq0z7xCglv7qGIs/68d3mAp+StfC8WKC5SSAg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="shortcut icon" href="../../_static/logo/mda_favicon.ico">
</head>

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NCDF, NC (AMBER NetCDF trajectory) &mdash; MDAnalysis User Guide  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/site.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />

  
    <link rel="canonical" href="https://userguide.mdanalysis.org/formats/reference/ncdf.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="../../_static/js/versions.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis User Guide  documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ParmEd (ParmEd Structure)" href="parmed.html" />
    <link rel="prev" title="MOL2 (Tripos structure)" href="mol2.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >




  




<a href="../../index.html">
  
    <img src="../../_static/user_guide.png" class="logo" alt="Logo"/>
</a>


  
  
  
    <div class="version">
      2.8.0-dev0
    </div>
  



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div>
<div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
    <!-- <p class="caption" role="heading"></p> -->
    <ul>
        
        <li class="toctree-l1"><a class="reference internal" href="https://mdanalysis.org">MDAnalysis</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="https://docs.mdanalysis.org/stable">API docs (stable)</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="https://docs.mdanalysis.org/dev">API docs (development)</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="https://mdakits.mdanalysis.org/">MDAKits</a></li>
        
    </ul>
    
        <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/quickstart.html">Quick start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/README.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases.html">MDAnalysis Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data structures</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../universe.html">Universe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../atomgroup.html">AtomGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../groups_of_atoms.html">Groups of atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../selections.html">Atom selection language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topology_system.html">The topology system</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Trajectories</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../trajectories/trajectories.html">Trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trajectories/slicing_trajectories.html">Slicing trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trajectories/transformations.html">On-the-fly transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../units.html">Units and constants</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Input/output</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../reading_and_writing.html">Reading and writing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Format overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guessing.html">Guessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auxiliary.html">Auxiliary files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selection_exporters.html">Selection exporters</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../format_reference.html">Format reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="chemfiles.html">chemfiles (chemfiles Trajectory or file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">CONFIG (DL_Poly Config)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#history-dl-poly-config">HISTORY (DL_Poly Config)</a></li>
<li class="toctree-l2"><a class="reference internal" href="coor.html">COOR, NAMBDIN (NAMD binary restart files)</a></li>
<li class="toctree-l2"><a class="reference internal" href="crd.html">CRD (CHARMM CARD files)</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">DATA (LAMMPS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="dcd.html">DCD (CHARMM, NAMD, or LAMMPS trajectory)</a></li>
<li class="toctree-l2"><a class="reference internal" href="dcd_lammps.html">DCD (Flexible LAMMPS trajectory)</a></li>
<li class="toctree-l2"><a class="reference internal" href="dms.html">DMS (Desmond Molecular Structure files)</a></li>
<li class="toctree-l2"><a class="reference internal" href="gms.html">GMS (Gamess trajectory)</a></li>
<li class="toctree-l2"><a class="reference internal" href="gro.html">GRO (GROMACS structure file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="gsd.html">GSD (HOOMD GSD file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="in.html">IN, FHIAIMS (FHI-aims input files)</a></li>
<li class="toctree-l2"><a class="reference internal" href="inpcrd.html">INPCRD, RESTRT (AMBER restart files)</a></li>
<li class="toctree-l2"><a class="reference internal" href="itp.html">ITP (GROMACS portable topology files)</a></li>
<li class="toctree-l2"><a class="reference internal" href="lammpsdump.html">LAMMPSDUMP (LAMMPS ascii dump file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mmtf.html">MMTF (Macromolecular Transmission Format)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mol2.html">MOL2 (Tripos structure)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">NCDF, NC (AMBER NetCDF trajectory)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#reading-in">Reading in</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writing-out">Writing out</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parmed.html">ParmEd (ParmEd Structure)</a></li>
<li class="toctree-l2"><a class="reference internal" href="pdb.html">PDB, ENT (Standard PDB file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="pdbqt.html">PDBQT (Autodock structure)</a></li>
<li class="toctree-l2"><a class="reference internal" href="pqr.html">PQR file (PDB2PQR / APBS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="psf.html">PSF (CHARMM, NAMD, or XPLOR protein structure file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tng.html">TNG (Trajectory Next Generation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="top.html">TOP, PRMTOP, PARM7 (AMBER topology)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tpr.html">TPR (GROMACS run topology files)</a></li>
<li class="toctree-l2"><a class="reference internal" href="trj.html">TRJ, MDCRD, CRDBOX (AMBER ASCII trajectory)</a></li>
<li class="toctree-l2"><a class="reference internal" href="trr.html">TRR (GROMACS lossless trajectory file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="trz.html">TRZ (IBIsCO and YASP trajectory)</a></li>
<li class="toctree-l2"><a class="reference internal" href="txyz.html">TXYZ, ARC (Tinker)</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml.html">XML (HOOMD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="xpdb.html">XPDB (Extended PDB file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="xtc.html">XTC (GROMACS compressed trajectory file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="xyz.html">XYZ trajectory</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html#alignments-and-rms-fitting">Alignments and RMS fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html#distances-and-contacts">Distances and contacts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html#trajectory-similarity">Trajectory similarity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html#structure">Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html#volumetric-analyses">Volumetric analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html#dimension-reduction">Dimension reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html#polymers-and-membranes">Polymers and membranes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html#hydrogen-bond-analysis">Hydrogen Bond Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/custom_trajectory_analysis.html">Writing your own trajectory analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/custom_parallel_analysis.html">Parallelizing analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../standard_selections.html">Standard residues in MDAnalysis selections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_topology.html">Advanced topology concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasets.html">Example data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing_code.html">Contributing to the main codebase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing_docs.html">Contributing to the user guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../preparing_releases_and_hotfixes.html">Preparing a release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../module_imports.html">Module imports in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing.html">Tests in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

</div>

      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MDAnalysis User Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../format_reference.html">Format reference</a></li>
      <li class="breadcrumb-item active">NCDF, NC (AMBER NetCDF trajectory)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/formats/reference/ncdf.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ncdf-nc-amber-netcdf-trajectory">
<span id="ncdf-format"></span><h1>NCDF, NC (AMBER NetCDF trajectory)<a class="headerlink" href="#ncdf-nc-amber-netcdf-trajectory" title="Link to this heading"></a></h1>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Coordinate reader</strong></p></td>
<td><p><a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/coordinates/TRJ.html#MDAnalysis.coordinates.TRJ.NCDFReader" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.TRJ.NCDFReader</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><strong>Coordinate writer</strong></p></td>
<td><p><a class="reference external" href="https://docs.mdanalysis.org/2.8.0-dev0/documentation_pages/coordinates/TRJ.html#MDAnalysis.coordinates.TRJ.NCDFWriter" title="(in MDAnalysis v2.8.0-dev0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.TRJ.NCDFWriter</span></code></a></p></td>
</tr>
</tbody>
</table>
<p><a class="reference external" href="https://ambermd.org/FileFormats.php#netcdf">AMBER binary trajectories</a> are automatically recognised by the file extension “.ncdf”. The NCDF module uses <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.io.netcdf</span></code> and therefore <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy</span></code> must be installed.</p>
<section id="reading-in">
<h2>Reading in<a class="headerlink" href="#reading-in" title="Link to this heading"></a></h2>
<p>Units are assumed to be the following default AMBER units:</p>
<blockquote>
<div><ul class="simple">
<li><p>length: Angstrom</p></li>
<li><p>time: ps</p></li>
</ul>
</div></blockquote>
<p>Currently, if other units are detected, MDAnalysis will raise a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a>.</p>
</section>
<section id="writing-out">
<h2>Writing out<a class="headerlink" href="#writing-out" title="Link to this heading"></a></h2>
<p>NCDF files are always written out in ångström and picoseconds.</p>
<p>Although scale_factors can be read from NCDF files, they are not kept or used when writing NCDF files out.</p>
<p><strong>Writing with the netCDF4 module and potential issues</strong></p>
<blockquote>
<div><p>Although <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.io.netcdf</span></code> is very fast at reading NetCDF files, it is slow at writing them out. The <a class="reference external" href="https://unidata.github.io/netcdf4-python/">netCDF4</a> package is fast at writing (but slow at reading). This requires the compiled netcdf library to be installed. MDAnalysis tries to use <code class="xref py py-mod docutils literal notranslate"><span class="pre">netCDF4</span></code> for writing if it is available, but will fall back to <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.io.netcdf</span></code> if it is not.</p>
<p><strong>AMBER users</strong> might have a hard time getting netCDF4 to work with a
conda-based installation (as discussed in <a class="reference external" href="https://github.com/MDAnalysis/mdanalysis/issues/506#issuecomment-225081416">Issue #506</a>) because of the way
that AMBER itself handles netcdf. In this scenario, MDAnalysis will simply switch to the scipy package. If you encounter this error and wish to use the the faster <code class="xref py py-mod docutils literal notranslate"><span class="pre">netCDF4</span></code> writer, the only solution is to unload the AMBER environment.</p>
</div></blockquote>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mol2.html" class="btn btn-neutral float-left" title="MOL2 (Tripos structure)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="parmed.html" class="btn btn-neutral float-right" title="ParmEd (ParmEd Structure)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2024, Lily Wang, Irfan Alibay, Patricio Barletta, Cédric Bouysset, Jan Domanski, Bjarne Feddersen, Mike Henry, Florent Langenfeld, Hugo MacDermott-Opeskin, Micaela Matta, Rocco Meli, Mahfuza Humayra Mohona, Paul Smith, Mieczyslaw Torchala, Mark Verma, Yuxuan Zhuang, Richard J. Gowers, and Oliver Beckstein..</p>
  </div>

  

<div class="footer"><p>Please see
    our <a href="https://www.mdanalysis.org/pages/privacy/">Privacy Policy</a>
    to learn how <a href="https://www.mdanalysis.org">MDAnalysis</a> collects data.</p>
    <script data-goatcounter="https://mdanalysis.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
    var versions_json_url = 'https://userguide.mdanalysis.org/versions.json'
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>