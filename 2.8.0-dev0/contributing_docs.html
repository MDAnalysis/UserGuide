


  
    
  




<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css" integrity="sha512-b1ASx0WHgVFL5ZQhTgiPWX+68KjS38Jk87jg7pe+qC7q9YkEtFq0z7xCglv7qGIs/68d3mAp+StfC8WKC5SSAg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="shortcut icon" href="_static/logo/mda_favicon.ico">
</head>

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contributing to the user guide &mdash; MDAnalysis User Guide  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/site.css" />
      <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />

  
    <link rel="canonical" href="https://userguide.mdanalysis.org/contributing_docs.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="_static/js/versions.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis User Guide  documentation"
          href="_static/opensearch.xml"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Preparing a release" href="preparing_releases_and_hotfixes.html" />
    <link rel="prev" title="Contributing to the main codebase" href="contributing_code.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >




  




<a href="index.html">
  
    <img src="_static/user_guide.png" class="logo" alt="Logo"/>
</a>


  
  
  
    <div class="version">
      2.8.0-dev0
    </div>
  



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div>
<div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
    <!-- <p class="caption" role="heading"></p> -->
    <ul>
        
        <li class="toctree-l1"><a class="reference internal" href="https://mdanalysis.org">MDAnalysis</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="https://docs.mdanalysis.org/stable">API docs (stable)</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="https://docs.mdanalysis.org/dev">API docs (development)</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="https://mdakits.mdanalysis.org/">MDAKits</a></li>
        
    </ul>
    
        <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/quickstart.html">Quick start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/README.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">MDAnalysis Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data structures</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="universe.html">Universe</a></li>
<li class="toctree-l1"><a class="reference internal" href="atomgroup.html">AtomGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="groups_of_atoms.html">Groups of atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="selections.html">Atom selection language</a></li>
<li class="toctree-l1"><a class="reference internal" href="topology_system.html">The topology system</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Trajectories</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="trajectories/trajectories.html">Trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="trajectories/slicing_trajectories.html">Slicing trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="trajectories/transformations.html">On-the-fly transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="units.html">Units and constants</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Input/output</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reading_and_writing.html">Reading and writing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="formats/index.html">Format overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="formats/guessing.html">Guessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="formats/auxiliary.html">Auxiliary files</a></li>
<li class="toctree-l1"><a class="reference internal" href="formats/selection_exporters.html">Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="formats/format_reference.html">Format reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html#alignments-and-rms-fitting">Alignments and RMS fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html#distances-and-contacts">Distances and contacts</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html#trajectory-similarity">Trajectory similarity</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html#structure">Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html#volumetric-analyses">Volumetric analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html#dimension-reduction">Dimension reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html#polymers-and-membranes">Polymers and membranes</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html#hydrogen-bond-analysis">Hydrogen Bond Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/custom_trajectory_analysis.html">Writing your own trajectory analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/custom_parallel_analysis.html">Parallelizing analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="standard_selections.html">Standard residues in MDAnalysis selections</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_topology.html">Advanced topology concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Example data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing_code.html">Contributing to the main codebase</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Contributing to the user guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#forking-and-cloning-the-user-guide">Forking and cloning the User Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-development-environment">Creating a development environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-new-documentation">Adding new documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-file-to-edit">What file to edit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restructuredtext-files">reStructuredText files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#jupyter-notebook-files">Jupyter notebook files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#building-the-user-guide">Building the user guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="#test-with-pytest-and-nbval">Test with pytest and nbval</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sanitization">Sanitization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#on-the-hole2-notebook">On the hole2 notebook</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#adding-changes-to-the-userguide">Adding changes to the UserGuide</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optional-steps-and-tips">Optional steps and tips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-pre-commit-hooks">Using pre-commit hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#automatically-building-documentation">Automatically building documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-preview-with-gh-pages">Advanced preview with gh-pages</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="preparing_releases_and_hotfixes.html">Preparing a release</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_imports.html">Module imports in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Tests in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

</div>

      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MDAnalysis User Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Contributing to the user guide</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/contributing_docs.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="contributing-to-the-user-guide">
<span id="working-with-user-guide"></span><h1>Contributing to the user guide<a class="headerlink" href="#contributing-to-the-user-guide" title="Link to this heading"></a></h1>
<p>MDAnalysis maintains two kinds of documentation:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><a class="reference external" href="https://www.mdanalysis.org/UserGuide/">This user guide</a>: a map of how MDAnalysis works, combined with tutorial-like overviews of specific topics (such as the analyses)</p></li>
<li><p><a class="reference external" href="https://www.mdanalysis.org/docs/">The documentation generated from the code itself</a>. Largely built from code docstrings, these are meant to provide a clear explanation of the usage of individual classes and functions. They often include technical or historical information such as in which version the function was added, or deprecation notices.</p></li>
</ol>
</div></blockquote>
<p>This guide is about how to contribute to the user guide. If you are looking to add to documentation of the main code base, please see <a class="reference internal" href="contributing_code.html#working-with-mdanalysis-docs"><span class="std std-ref">Working with the code documentation</span></a>.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>Many code examples in the docs are run during the
doc build. This approach means that code examples will always be up to date,
but it does make the doc building a bit more complex.</p>
<p>Here is an overview of the development workflow for the user guide, as expanded on throughout the rest of the page.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><a class="reference internal" href="#forking-user-guide"><span class="std std-ref">Fork the MDAnalysis repository</span></a> from the mdanalysis account into your own account</p></li>
<li><p><a class="reference internal" href="#create-virtual-environment-user-guide"><span class="std std-ref">Set up an isolated virtual environment</span></a> for your documentation</p></li>
<li><p><a class="reference internal" href="contributing_code.html#create-code-branch"><span class="std std-ref">Create a new branch off the develop branch</span></a></p></li>
<li><p>Add your new documentation.</p></li>
<li><p><a class="reference internal" href="#build-user-guide"><span class="std std-ref">Build and view the documentation</span></a>.</p></li>
<li><p><a class="reference internal" href="#nbval-testing"><span class="std std-ref">Test your notebook cells, if applicable</span></a>.</p></li>
<li><p><a class="reference internal" href="#add-changes-user-guide"><span class="std std-ref">Commit and push your changes, and open a pull request</span></a>.</p></li>
</ol>
</div></blockquote>
</section>
<section id="forking-and-cloning-the-user-guide">
<span id="forking-user-guide"></span><h2>Forking and cloning the User Guide<a class="headerlink" href="#forking-and-cloning-the-user-guide" title="Link to this heading"></a></h2>
<p>Go to the <a class="reference external" href="https://github.com/MDAnalysis/UserGuide">MDAnalysis project page</a> and hit the <span class="guilabel">Fork</span> button. You will
want to clone your fork to your machine:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/your-user-name/UserGuide.git
<span class="nb">cd</span><span class="w"> </span>UserGuide
git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>upstream<span class="w"> </span>https://github.com/MDAnalysis/UserGuide
</pre></div>
</div>
</div></blockquote>
<p>This creates the directory <cite>UserGuide</cite> and connects your repository to
the upstream (main project) MDAnalysis repository.</p>
</section>
<section id="creating-a-development-environment">
<span id="create-virtual-environment-user-guide"></span><h2>Creating a development environment<a class="headerlink" href="#creating-a-development-environment" title="Link to this heading"></a></h2>
<p><a class="reference internal" href="contributing_code.html#create-virtual-environment"><span class="std std-ref">Create a new virtual environment</span></a> for the user guide. Install the required dependencies, and activate the <code class="docutils literal notranslate"><span class="pre">nglview</span></code> extension. We use <code class="docutils literal notranslate"><span class="pre">nglview</span></code> for visualizing molecules in Jupyter notebook tutorials.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">conda</span></code> or similar (<code class="docutils literal notranslate"><span class="pre">miniconda</span></code>, <code class="docutils literal notranslate"><span class="pre">mamba</span></code>, <code class="docutils literal notranslate"><span class="pre">micromamba</span></code>), create a new environment with all the dependencies:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>UserGuide/
conda<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>--file<span class="w"> </span>environment.yml<span class="w"> </span>--quiet
conda<span class="w"> </span>activate<span class="w"> </span>mda-user-guide
jupyter-nbextension<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>nglview<span class="w"> </span>--py<span class="w"> </span>--sys-prefix
</pre></div>
</div>
</div></blockquote>
</section>
<section id="adding-new-documentation">
<span id="add-new-documentation"></span><h2>Adding new documentation<a class="headerlink" href="#adding-new-documentation" title="Link to this heading"></a></h2>
<p>The documentation is built using <a class="reference external" href="https://www.sphinx-doc.org/en/master/">Sphinx</a>.
The user guide is largely composed of four different kinds of files:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#restructuredtext-files"><span class="std std-ref">reStructuredText files</span></a> (<code class="docutils literal notranslate"><span class="pre">.rst</span></code>) which contain the text of the documentation</p></li>
<li><p><a class="reference internal" href="#jupyter-files"><span class="std std-ref">Jupyter notebooks</span></a> (<code class="docutils literal notranslate"><span class="pre">.ipynb</span></code>) which contain code examples</p></li>
<li><p>Python scripts (<code class="docutils literal notranslate"><span class="pre">.py</span></code>) in the <code class="docutils literal notranslate"><span class="pre">doc/source/scripts/</span></code> directory which are used
for automatically generated documentation</p></li>
<li><p>Text files (<code class="docutils literal notranslate"><span class="pre">.txt</span></code>) which contain the automatically generated documentation.
These should not be edited directly as changes will not be included.
These are largely tables and lists of topology attributes for readers, writers,
and parsers.</p></li>
</ul>
<section id="what-file-to-edit">
<h3>What file to edit<a class="headerlink" href="#what-file-to-edit" title="Link to this heading"></a></h3>
<p>In order to figure out which file you should be editing, the easiest
way is probably to <code class="docutils literal notranslate"><span class="pre">ctrl+F</span></code> or otherwise search through the repository
for the text you want to edit. Otherwise, you can look at the
<code class="docutils literal notranslate"><span class="pre">index.rst</span></code> file in the <code class="docutils literal notranslate"><span class="pre">doc/source</span></code> directory.
This file contains the <em>home page</em> of the user guide and the “overall”
tables of contents for the rest of the documentation.</p>
<p>For example, the
<code class="docutils literal notranslate"><span class="pre">index.rst</span></code> file might contain the following lines:</p>
<blockquote>
<div><div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">toctree</span><span class="p">::</span>
    <span class="nc">:maxdepth:</span> 1
    <span class="nc">:caption:</span> Getting started
    <span class="nc">:hidden:</span>

    installation
    examples/quickstart
    faq
    examples/README
</pre></div>
</div>
</div></blockquote>
<p>This tells Sphinx that the first three entries in the “Getting started” section
of the documentation are:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">installation.rst</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">examples/quickstart.ipynb</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">faq.rst</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">examples/README.rst</span></code></p></li>
</ol>
</div></blockquote>
<p>All internal links in the user guide are relative to the <code class="docutils literal notranslate"><span class="pre">doc/source</span></code> directory.
<code class="docutils literal notranslate"><span class="pre">installation.rst</span></code>, therefore, can be found at <code class="docutils literal notranslate"><span class="pre">UserGuide/doc/source/installation.rst</span></code>.
This is the file you should edit if you want to change the installation instructions.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">examples/quickstart.ipynb</span></code> entry is a Jupyter notebook.
We use the <a class="reference external" href="https://nbsphinx.readthedocs.io">nbsphinx</a> extension to convert Jupyter notebooks to HTML
during the doc build. All changes to the Quickstart guide should be made
to the Jupyter notebook itself, and changes will be reflected in the final
documentation.</p>
</section>
<section id="restructuredtext-files">
<span id="id1"></span><h3>reStructuredText files<a class="headerlink" href="#restructuredtext-files" title="Link to this heading"></a></h3>
<p>These are the files that end in <code class="docutils literal notranslate"><span class="pre">.rst</span></code> and contain plain text.
reStructuredText is a markup language that is used to write
documentation for Sphinx in Python.
The <a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/restructuredtext/basics.html">reStructuredText Primer</a>
is a good place to start if you are unfamiliar with the syntax.</p>
<p>The user guide also makes use of a number of Sphinx extensions to ensure that the code examples are always up-to-date.
One example is the <a class="reference external" href="https://matplotlib.org/sampledoc/ipython_directive.html">ipython directive</a>.
The <code class="docutils literal notranslate"><span class="pre">ipython</span></code> directive lets you put code in the documentation which will be run
during the doc build. For example:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">ipython</span><span class="p">::</span> <span class="n">python</span>

    <span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">x</span><span class="o">**</span><span class="mi">3</span>
</pre></div>
</div>
</div></blockquote>
<p>will be rendered as:</p>
<blockquote>
<div><div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>

<span class="gp">In [2]: </span><span class="n">x</span><span class="o">**</span><span class="mi">3</span>
<span class="gh">Out[2]: </span><span class="go">8</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="jupyter-notebook-files">
<span id="jupyter-files"></span><h3>Jupyter notebook files<a class="headerlink" href="#jupyter-notebook-files" title="Link to this heading"></a></h3>
<p>Jupyter notebooks are a great way to write documentation, since they allow you to
write text and code in the same document. The user guide uses Jupyter notebooks
for all the tutorials and examples.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>One of the neat things about <code class="docutils literal notranslate"><span class="pre">nglview</span></code> is the ability to interact with molecules via the viewer.
Many of our notebooks include cells that render MDAnalysis systems.
However, this creates very large files.
<strong>We ask that you avoid saving the state of the viewer in the notebooks.</strong>
We also ask in general that you leave NGLView cells commented out.</p>
</div>
<p>Everything in the <code class="docutils literal notranslate"><span class="pre">doc/source/examples/</span></code> directory is a Jupyter notebook.
They are rendered in the user guide on the
<a class="reference external" href="https://userguide.mdanalysis.org/stable/examples/README.html">“Examples”</a> page, and
are also listed in the
<a class="reference external" href="https://userguide.mdanalysis.org/stable/examples/analysis/README.html">“Analysis”</a>
section of the user guide.</p>
<p>Jupyter notebooks should be edited and created using the User guide environment
that you created in the <a class="reference internal" href="#create-virtual-environment-user-guide"><span class="std std-ref">previous section</span></a>.</p>
<p>When you add a new Jupyter notebook, you should add it to the <code class="docutils literal notranslate"><span class="pre">doc/source/examples/</span></code>
directory and add a link to it in the <code class="docutils literal notranslate"><span class="pre">doc/source/examples/README.rst</span></code> file.</p>
<p>Further notes on testing Jupyter notebooks are included below.</p>
</section>
</section>
<section id="building-the-user-guide">
<span id="build-user-guide"></span><h2>Building the user guide<a class="headerlink" href="#building-the-user-guide" title="Link to this heading"></a></h2>
<p>Navigate to the <code class="docutils literal notranslate"><span class="pre">doc/</span></code> directory and run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html</span></code>:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>doc/
make<span class="w"> </span>html
</pre></div>
</div>
</div></blockquote>
<p>The HTML output will be in <code class="docutils literal notranslate"><span class="pre">doc/build/</span></code>, which you can open in your browser of choice. The homepage is <code class="docutils literal notranslate"><span class="pre">doc/build/index.html</span></code>.</p>
<p>If rebuilding the documentation becomes tedious after a while, install the <a class="reference internal" href="#autobuild-sphinx"><span class="std std-ref">sphinx-autobuild</span></a> extension.</p>
</section>
<section id="test-with-pytest-and-nbval">
<span id="nbval-testing"></span><h2>Test with pytest and nbval<a class="headerlink" href="#test-with-pytest-and-nbval" title="Link to this heading"></a></h2>
<p>Whenever you add or modify notebook cells, you should make sure they run without errors and that their
outputs are consistent, since they are part of the documentation as well.</p>
<p>We use a pytest plugin for this called <a class="reference external" href="https://nbval.readthedocs.io/en/latest/">nbval</a>, it takes advantage of the saved notebook state
and re-runs the notebook to determine if its output is still identical to the saved state.
Thus, cells not only have to work (no errors), but also must give the same output they gave when
they were saved.</p>
<p>To test all notebooks, just cd into <code class="docutils literal notranslate"><span class="pre">UserGuide/tests</span></code> and run <code class="docutils literal notranslate"><span class="pre">pytest</span></code>.
If you want to test a particular notebook, check the the contents of <cite>pytest.ini</cite>, this file
defines flags that you can also pass directly to pytest.
For example, if you wanted to test the <cite>hole2</cite> notebook:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="o">--</span><span class="n">nbval</span> <span class="o">--</span><span class="n">nbval</span><span class="o">-</span><span class="n">current</span><span class="o">-</span><span class="n">env</span> <span class="o">--</span><span class="n">nbval</span><span class="o">-</span><span class="n">sanitize</span><span class="o">-</span><span class="k">with</span> <span class="o">./</span><span class="n">sanitize_output</span><span class="o">.</span><span class="n">cfg</span> <span class="o">../</span><span class="n">doc</span><span class="o">/</span><span class="n">source</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">analysis</span><span class="o">/</span><span class="n">polymers_and_membranes</span><span class="o">/</span><span class="n">hole2</span><span class="o">.</span><span class="n">ipynb</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">--nbval</span></code> tells pytest to use nbval to test Jupyter notebooks, <code class="docutils literal notranslate"><span class="pre">--nbval-current-env</span></code>
to use the currently loaded python environment (make sure you actually loaded your environment)
instead of trying to use the one that was used when the notebook was saved  and
<code class="docutils literal notranslate"><span class="pre">--nbval-sanitize-with</span></code> to point pytest to a file full of replacement rules like this one
for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">regex</span><span class="p">:</span> <span class="p">(</span><span class="o">.*</span><span class="n">B</span> \<span class="p">[</span><span class="mf">0.</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">s</span>\<span class="p">])</span>
<span class="n">replace</span><span class="p">:</span> <span class="n">DOWNLOAD</span>
</pre></div>
</div>
<p>This tells pytest to scan the outputs of all cells and replace the matching string with the word
<em>DOWNLOAD</em>. This is called <em>sanitization</em>.</p>
<section id="sanitization">
<h3>Sanitization<a class="headerlink" href="#sanitization" title="Link to this heading"></a></h3>
<p>Exactly matching cell outputs between runs is a high bar for testing and tends to give false errors
– otherwise correct cells may give different outputs each time they are run (e.g. cells with code
that outputs memory locations).
To alleviate this, before testing each cell pytest will match its output against the regular
expressions from <code class="docutils literal notranslate"><span class="pre">sanitize_output.cfg</span></code>. This file contains replacements for strings that we know will vary.
Pytest will replace the dynamic output with these constant strings, which won’t change between runs and hence prevent spurious failures.</p>
<p>If your code correctly outputs variable strings each time its run, you should add a replacement
rule to the <code class="docutils literal notranslate"><span class="pre">sanitize_output.cfg</span></code> file and try to make it as specific as possible.</p>
</section>
<section id="on-the-hole2-notebook">
<h3>On the hole2 notebook<a class="headerlink" href="#on-the-hole2-notebook" title="Link to this heading"></a></h3>
<p>The <em>hole2</em> notebook is special in that it requires installation of extra software to run,
namely the <a class="reference external" href="https://github.com/osmart/hole2">hole2</a> program. If you test all the notebooks you may therefore run
into errors if hole2 is not installed. These errors can be generally ignored unless
you do specifically want to test the hole2 notebook. Of course, you should take
note of other errors that occur if hole2 is installed!
To run the hole2 notebook you’ll have to install <a class="reference external" href="https://github.com/osmart/hole2">hole2</a> as described in its documentation. (For Linux, a conda-forge package is available, for other platforms you may have to compile it yourself.)</p>
</section>
</section>
<section id="adding-changes-to-the-userguide">
<span id="add-changes-user-guide"></span><h2>Adding changes to the UserGuide<a class="headerlink" href="#adding-changes-to-the-userguide" title="Link to this heading"></a></h2>
<p>As with the code, <a class="reference internal" href="contributing_code.html#adding-code-to-mda"><span class="std std-ref">commit and push</span></a> your code to GitHub.
Then <a class="reference internal" href="contributing_code.html#id6"><span class="std std-ref">create a pull request</span></a>.
The only test run for the User Guide is that your file compile into HTML documents without errors.
As usual, your PR will be reviewed and merged into the User Guide when it looks good.</p>
<p>If you have issues building your documentation locally, opening a pull request
creates preview documentation on ReadTheDocs, which you can use to check renders.
We believe it is best to open PRs early and often, so that we can catch issues early!</p>
</section>
<section id="optional-steps-and-tips">
<h2>Optional steps and tips<a class="headerlink" href="#optional-steps-and-tips" title="Link to this heading"></a></h2>
<p>The below sections are optional, but may be helpful for more advanced users.</p>
<section id="using-pre-commit-hooks">
<h3>Using pre-commit hooks<a class="headerlink" href="#using-pre-commit-hooks" title="Link to this heading"></a></h3>
<p>Manually editing files can often lead to small inconsistencies: a whitespace here, a missing carriage return there.
A tool called <a class="reference external" href="https://pre-commit.com/">pre-commit</a> can be used to automatically fix these problems, before a git commit is made.
To enable the pre-commit hooks, run the following:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pre-commit<span class="w"> </span>install
</pre></div>
</div>
</div></blockquote>
<p>To perform the pre-commit checks on all the files, run the following:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pre-commit<span class="w"> </span>run<span class="w"> </span>--all-files
</pre></div>
</div>
</div></blockquote>
<p>To remove the pre-commit hooks from your .git directory, run the following:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pre-commit<span class="w"> </span>uninstall
</pre></div>
</div>
</div></blockquote>
</section>
<section id="automatically-building-documentation">
<span id="autobuild-sphinx"></span><h3>Automatically building documentation<a class="headerlink" href="#automatically-building-documentation" title="Link to this heading"></a></h3>
<p>Constantly rebuilding documentation can become tedious when you have many changes to make. Use <a class="reference external" href="https://pypi.org/project/sphinx-autobuild">sphinx-autobuild</a> to rebuild documentation every time you make changes to any document, including Jupyter notebooks. Install <code class="docutils literal notranslate"><span class="pre">sphinx-autobuild</span></code>:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>sphinx-autobuild
</pre></div>
</div>
</div></blockquote>
<p>Then, run the following command in the <code class="docutils literal notranslate"><span class="pre">doc/</span></code> directory:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>sphinx_autobuild<span class="w"> </span><span class="nb">source</span><span class="w"> </span>build
</pre></div>
</div>
</div></blockquote>
<p>This will start a local webserver at <a class="reference external" href="http://localhost:8000/">http://localhost:8000/</a>, which will refresh every time you save changes to a file in the documentation. This is helpful for both the user guide (first navigate to <code class="docutils literal notranslate"><span class="pre">UserGuide/doc</span></code>) and the main repository documentation (navigate to <code class="docutils literal notranslate"><span class="pre">package/doc/sphinx</span></code>).</p>
</section>
<section id="advanced-preview-with-gh-pages">
<h3>Advanced preview with gh-pages<a class="headerlink" href="#advanced-preview-with-gh-pages" title="Link to this heading"></a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This section documents how to render documentation on a fork without ReadTheDocs.
This is <em>generally unnecessary</em> and should only be done in cases where we
believe ReadTheDocs is not rendering our documentation properly.
For all other cases, please use the ReadTheDocs preview in pull requests.</p>
</div>
<p>It is often difficult to review Jupyter notebooks on GitHub, especially if you embed widgets and images.
If you make a pull request to the User Guide, we do make use of the <a class="reference external" href="https://www.reviewnb.com/">ReviewNB</a> for reviewing Jupyter notebooks.
Another way to make it easier on the developers who review your changes is to build the changes on your forked repository and link the relevant sections in your pull request.
To do this, create a <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch and merge your new branch into it.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># the first time</span>
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>gh-pages
git<span class="w"> </span>merge<span class="w"> </span>origin/my-new-branch
</pre></div>
</div>
<p>Fix any merge conflicts that arise. Then edit <code class="docutils literal notranslate"><span class="pre">UserGuide/doc/source/conf.py</span></code> and change the URL of the site, which is set to <code class="docutils literal notranslate"><span class="pre">site_url</span> <span class="pre">=</span> <span class="pre">&quot;https://www.mdanalysis.org/UserGuide&quot;</span></code>. Change it to your personal site, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">site_url</span> <span class="o">=</span> <span class="s2">&quot;https://www.my_user_name.github.io/UserGuide&quot;</span>
</pre></div>
</div>
<p>Now you can build your pages with the <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">github</span></code> macro in the <code class="docutils literal notranslate"><span class="pre">UserGuide/doc/</span></code> directory, which builds the files and copies them to the top level of your directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>github
</pre></div>
</div>
<p>You should be able to open one of these new HTML files (e.g. <code class="docutils literal notranslate"><span class="pre">UserGuide/index.html</span></code>) in a browser and navigate your new documentation. Check that your changes look right. If they are, push to your <cite>gh-pages</cite> branch from the <code class="docutils literal notranslate"><span class="pre">UserGuide/</span></code> directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;built my-new-branch&#39;</span>
git<span class="w"> </span>push<span class="w"> </span>-f<span class="w"> </span>origin<span class="w"> </span>gh-pages
</pre></div>
</div>
<p>On GitHub, navigate to your fork of the repository and go to <strong>Settings</strong>. In the <strong>GitHub Pages</strong> section, select the “gh-pages branch” from the <strong>Source</strong> dropdown. Check that your website is published at the given URL.</p>
<img alt="_images/gh-pages-settings.png" src="_images/gh-pages-settings.png" />
<p>For each time you add changes to another branch later, just merge into gh-pages and rebuild.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>checkout<span class="w"> </span>gh-pages
git<span class="w"> </span>merge<span class="w"> </span>origin/my_branch
<span class="nb">cd</span><span class="w"> </span>doc/
make<span class="w"> </span>github
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="contributing_code.html" class="btn btn-neutral float-left" title="Contributing to the main codebase" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="preparing_releases_and_hotfixes.html" class="btn btn-neutral float-right" title="Preparing a release" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2024, Lily Wang, Irfan Alibay, Patricio Barletta, Cédric Bouysset, Jan Domanski, Bjarne Feddersen, Mike Henry, Florent Langenfeld, Hugo MacDermott-Opeskin, Micaela Matta, Rocco Meli, Paul Smith, Mieczyslaw Torchala, Mark Verma, Yuxuan Zhuang, Richard J. Gowers, and Oliver Beckstein..</p>
  </div>

  

<div class="footer"><p>Please see
    our <a href="https://www.mdanalysis.org/pages/privacy/">Privacy Policy</a>
    to learn how <a href="https://www.mdanalysis.org">MDAnalysis</a> collects data.</p>
    <script data-goatcounter="https://mdanalysis.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
    var versions_json_url = 'https://userguide.mdanalysis.org/versions.json'
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>