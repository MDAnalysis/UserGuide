<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Writing your own trajectory analysis &mdash; MDAnalysis User Guide  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/msmb.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/nbsphinx-code-cells.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="canonical" href="https://userguide.mdanalysis.org/examples/analysis/custom_trajectory_analysis.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="../../_static/js/versions.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis User Guide  documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Parallelizing analysis" href="custom_parallel_analysis.html" />
    <link rel="prev" title="Calculating hydrogen bond lifetimes" href="hydrogen_bonds/hbonds-lifetimes.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/user_guide.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.6.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Examples</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.mdanalysis.org/stable/index.html">API docs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data structures</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../universe.html">Universe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../atomgroup.html">AtomGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../groups_of_atoms.html">Groups of atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../selections.html">Atom selection language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topology_system.html">The topology system</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Trajectories</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../trajectories/trajectories.html">Trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trajectories/slicing_trajectories.html">Slicing trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trajectories/transformations.html">On-the-fly transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../units.html">Units and constants</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Input/output</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reading_and_writing.html">Reading and writing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../formats/index.html">Format overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../formats/guessing.html">Guessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../formats/auxiliary.html">Auxiliary files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../formats/selection_exporters.html">Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../formats/format_reference.html">Format reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Analysis</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#alignments-and-rms-fitting">Alignments and RMS fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#distances-and-contacts">Distances and contacts</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#trajectory-similarity">Trajectory similarity</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#structure">Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#volumetric-analyses">Volumetric analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#dimension-reduction">Dimension reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#polymers-and-membranes">Polymers and membranes</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#hydrogen-bond-analysis">Hydrogen Bond Analysis</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Writing your own trajectory analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Radius-of-gyration">Radius of gyration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Loading-files">Loading files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Creating-an-analysis-from-a-function">Creating an analysis from a function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Transforming-a-function-into-a-class">Transforming a function into a class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Creating-your-own-class">Creating your own class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#1.-Define-__init__">1. Define <code class="docutils literal notranslate"><span class="pre">__init__</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.-Define-your-analysis-in-_single_frame()-and-other-methods">2. Define your analysis in <code class="docutils literal notranslate"><span class="pre">_single_frame()</span></code> and other methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Contributing-to-MDAnalysis">Contributing to MDAnalysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="custom_parallel_analysis.html">Parallelizing analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../standard_selections.html">Standard residues in MDAnalysis selections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_topology.html">Advanced topology concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasets.html">Example data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing_code.html">Contributing to the main codebase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing_docs.html">Contributing to the user guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../preparing_releases_and_hotfixes.html">Preparing a release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../module_imports.html">Module imports in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing.html">Tests in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.mdanalysis.org/dev/index.html">Development docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MDAnalysis User Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Writing your own trajectory analysis</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/examples/analysis/custom_trajectory_analysis.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <script src='http://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js'></script>
<script>require=requirejs;</script><section id="Writing-your-own-trajectory-analysis">
<h1>Writing your own trajectory analysis<a class="headerlink" href="#Writing-your-own-trajectory-analysis" title="Link to this heading"></a></h1>
<p>We create our own analysis methods for calculating the radius of gyration of a selection of atoms.</p>
<p>This can be done three ways, from least to most flexible:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#Creating-an-analysis-from-a-function"><span class="std std-ref">Running the analysis directly from a function</span></a></p></li>
<li><p><a class="reference internal" href="#Transforming-a-function-into-a-class"><span class="std std-ref">Turning a function into a class</span></a></p></li>
<li><p><a class="reference internal" href="#Creating-your-own-class"><span class="std std-ref">Writing your own class</span></a></p></li>
</ol>
<p>The building blocks and methods shown here are only suitable for analyses that involve iterating over the trajectory once.</p>
<p>If you implement your own analysis method, please consider <a class="reference external" href="https://www.mdanalysis.org/UserGuide/contributing.html">contributing it to the MDAnalysis codebase!</a></p>
<p><strong>Last updated:</strong> December 2022 with MDAnalysis 2.4.0-dev0</p>
<p><strong>Minimum version of MDAnalysis:</strong> 2.0.0</p>
<p><strong>Packages required:</strong></p>
<ul class="simple">
<li><p>MDAnalysis (<span id="id1">[<a class="reference internal" href="../../references.html#id11" title="Naveen Michaud-Agrawal, Elizabeth J. Denning, Thomas B. Woolf, and Oliver Beckstein. MDAnalysis: A toolkit for the analysis of molecular dynamics simulations. Journal of Computational Chemistry, 32(10):2319–2327, July 2011. 00778. URL: http://doi.wiley.com/10.1002/jcc.21787 (visited on 2020-02-05), doi:10.1002/jcc.21787.">MADWB11</a>]</span>, <span id="id2">[<a class="reference internal" href="../../references.html#id3" title="Richard J. Gowers, Max Linke, Jonathan Barnoud, Tyler J. E. Reddy, Manuel N. Melo, Sean L. Seyler, Jan Domański, David L. Dotson, Sébastien Buchoux, Ian M. Kenney, and Oliver Beckstein. MDAnalysis: A Python Package for the Rapid Analysis of Molecular Dynamics Simulations. Proceedings of the 15th Python in Science Conference, pages 98–105, 2016. 00152. URL: https://conference.scipy.org/proceedings/scipy2016/oliver_beckstein.html (visited on 2020-02-05), doi:10.25080/Majora-629e541a-00e.">GLB+16</a>]</span>)</p></li>
<li><p>MDAnalysisTests</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">PSF</span><span class="p">,</span> <span class="n">DCD</span><span class="p">,</span> <span class="n">DCD2</span>
<span class="kn">from</span> <span class="nn">MDAnalysis.analysis.base</span> <span class="kn">import</span> <span class="p">(</span><span class="n">AnalysisBase</span><span class="p">,</span>
                                      <span class="n">AnalysisFromFunction</span><span class="p">,</span>
                                      <span class="n">analysis_class</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<section id="Radius-of-gyration">
<h2>Radius of gyration<a class="headerlink" href="#Radius-of-gyration" title="Link to this heading"></a></h2>
<p>Let’s start off by defining a standalone analysis function.</p>
<p>The radius of gyration of a structure measures how compact it is. In <a class="reference external" href="http://manual.gromacs.org/documentation/2019-rc1/reference-manual/analysis/radius-of-gyration.html">GROMACS</a>, it is calculated as follows:</p>
<div class="math notranslate nohighlight">
\[R_g = \sqrt{\frac{\sum_i m_i \mathbf{r}_i^2}{\sum_i m_i}}\]</div>
<p>where <span class="math notranslate nohighlight">\(m_i\)</span> is the mass of atom <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(\mathbf{r}_i\)</span> is the position of atom <span class="math notranslate nohighlight">\(i\)</span>, relative to the center-of-mass of the selection.</p>
<p>The radius of gyration around each axis can also be determined separately. For example, the radius of gyration around the x-axis:</p>
<div class="math notranslate nohighlight">
\[R_{i, x} = \sqrt{\frac{\sum_i m_i [r_{i, y}^2 + r_{i, z}^2]}{\sum_i m_i}}\]</div>
<p>Below, we define a function that takes an AtomGroup and calculates the radii of gyration. We could write this function to only need the AtomGroup. However, we also add in a <code class="docutils literal notranslate"><span class="pre">masses</span></code> argument and a <code class="docutils literal notranslate"><span class="pre">total_mass</span></code> keyword to avoid recomputing the mass and total mass for each frame.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">radgyr</span><span class="p">(</span><span class="n">atomgroup</span><span class="p">,</span> <span class="n">masses</span><span class="p">,</span> <span class="n">total_mass</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># coordinates change for each frame</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="n">atomgroup</span><span class="o">.</span><span class="n">positions</span>
    <span class="n">center_of_mass</span> <span class="o">=</span> <span class="n">atomgroup</span><span class="o">.</span><span class="n">center_of_mass</span><span class="p">()</span>

    <span class="c1"># get squared distance from center</span>
    <span class="n">ri_sq</span> <span class="o">=</span> <span class="p">(</span><span class="n">coordinates</span><span class="o">-</span><span class="n">center_of_mass</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="c1"># sum the unweighted positions</span>
    <span class="n">sq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ri_sq</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sq_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ri_sq</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># sum over y and z</span>
    <span class="n">sq_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ri_sq</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># sum over x and z</span>
    <span class="n">sq_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ri_sq</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># sum over x and y</span>

    <span class="c1"># make into array</span>
    <span class="n">sq_rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sq</span><span class="p">,</span> <span class="n">sq_x</span><span class="p">,</span> <span class="n">sq_y</span><span class="p">,</span> <span class="n">sq_z</span><span class="p">])</span>

    <span class="c1"># weight positions</span>
    <span class="n">rog_sq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">masses</span><span class="o">*</span><span class="n">sq_rs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">total_mass</span>
    <span class="c1"># square root and return</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rog_sq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Loading-files">
<h2>Loading files<a class="headerlink" href="#Loading-files" title="Link to this heading"></a></h2>
<p>The test files we will be working with here feature adenylate kinase (AdK), a phosophotransferase enzyme. (<span id="id3">[<a class="reference internal" href="../../references.html#id14" title="Oliver Beckstein, Elizabeth J. Denning, Juan R. Perilla, and Thomas B. Woolf. Zipping and Unzipping of Adenylate Kinase: Atomistic Insights into the Ensemble of Open↔Closed Transitions. Journal of Molecular Biology, 394(1):160–176, November 2009. 00107. URL: https://linkinghub.elsevier.com/retrieve/pii/S0022283609011164 (visited on 2020-02-05), doi:10.1016/j.jmb.2009.09.009.">BDPW09</a>]</span>)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PSF</span><span class="p">,</span> <span class="n">DCD</span><span class="p">)</span>
<span class="n">protein</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;protein&#39;</span><span class="p">)</span>

<span class="n">u2</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PSF</span><span class="p">,</span> <span class="n">DCD2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/pbarletta/mambaforge/envs/guide/lib/python3.9/site-packages/MDAnalysis/coordinates/DCD.py:165: DeprecationWarning: DCDReader currently makes independent timesteps by copying self.ts while other readers update self.ts inplace. This behavior will be changed in 3.0 to be the same as other readers. Read more at https://github.com/MDAnalysis/mdanalysis/issues/3889 to learn if this change in behavior might affect you.
  warnings.warn(&#34;DCDReader currently makes independent timesteps&#34;
</pre></div></div>
</div>
</section>
<section id="Creating-an-analysis-from-a-function">
<h2>Creating an analysis from a function<a class="headerlink" href="#Creating-an-analysis-from-a-function" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.base.AnalysisFromFunction</span></code> can create an analysis from a function that works on AtomGroups. It requires the function itself, the trajectory to operate on, and then the arguments / keyword arguments necessary for the function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rog</span> <span class="o">=</span> <span class="n">AnalysisFromFunction</span><span class="p">(</span><span class="n">radgyr</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">,</span>
                           <span class="n">protein</span><span class="p">,</span> <span class="n">protein</span><span class="o">.</span><span class="n">masses</span><span class="p">,</span>
                           <span class="n">total_mass</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">protein</span><span class="o">.</span><span class="n">masses</span><span class="p">))</span>
<span class="n">rog</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;MDAnalysis.analysis.base.AnalysisFromFunction at 0x7f901a31bca0&gt;
</pre></div></div>
</div>
<p>Running the analysis iterates over the trajectory. The output is saved in <code class="docutils literal notranslate"><span class="pre">rog.results.timeseries</span></code>, which has the same number of rows, as frames in the trajectory. You can access the results both at <code class="docutils literal notranslate"><span class="pre">rog.results.timeseries</span></code> and <code class="docutils literal notranslate"><span class="pre">rog.results['timeseries']</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rog</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;timeseries&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(98, 4)
</pre></div></div>
</div>
<p>gives the same outputs as:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rog</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">timeseries</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(98, 4)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;x-axis&#39;</span><span class="p">,</span> <span class="s1">&#39;y-axis&#39;</span><span class="p">,</span> <span class="s1">&#39;z-axis&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rog</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;timeseries&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Radius of gyration (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frame&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;Frame&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_analysis_custom_trajectory_analysis_12_1.png" src="../../_images/examples_analysis_custom_trajectory_analysis_12_1.png" />
</div>
</div>
<p>You can also re-run the analysis with different frame selections.</p>
<p>Below, we start from the 10th frame and take every 8th frame until the 80th. Note that the slice includes the <code class="docutils literal notranslate"><span class="pre">start</span></code> frame, but does not include the <code class="docutils literal notranslate"><span class="pre">stop</span></code> frame index (much like the actual <code class="docutils literal notranslate"><span class="pre">range()</span></code> function).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rog_10</span> <span class="o">=</span> <span class="n">AnalysisFromFunction</span><span class="p">(</span><span class="n">radgyr</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">,</span>
                              <span class="n">protein</span><span class="p">,</span> <span class="n">protein</span><span class="o">.</span><span class="n">masses</span><span class="p">,</span>
                              <span class="n">total_mass</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">protein</span><span class="o">.</span><span class="n">masses</span><span class="p">))</span>

<span class="n">rog_10</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">rog_10</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;timeseries&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(10, 4)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rog_10</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;timeseries&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Radius of gyration (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frame&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;Frame&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_analysis_custom_trajectory_analysis_15_1.png" src="../../_images/examples_analysis_custom_trajectory_analysis_15_1.png" />
</div>
</div>
</section>
<section id="Transforming-a-function-into-a-class">
<h2>Transforming a function into a class<a class="headerlink" href="#Transforming-a-function-into-a-class" title="Link to this heading"></a></h2>
<p>While the <code class="docutils literal notranslate"><span class="pre">AnalysisFromFunction</span></code> is convenient for quick analyses, you may want to turn your function into a class that can be applied to many different trajectories, much like other MDAnalysis analyses.</p>
<p>You can apply <code class="docutils literal notranslate"><span class="pre">analysis_class</span></code> to any function that you can run with <code class="docutils literal notranslate"><span class="pre">AnalysisFromFunction</span></code> to get a class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RadiusOfGyration</span> <span class="o">=</span> <span class="n">analysis_class</span><span class="p">(</span><span class="n">radgyr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To run the analysis, pass exactly the same arguments as you would for <code class="docutils literal notranslate"><span class="pre">AnalysisFromFunction</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rog_u1</span> <span class="o">=</span> <span class="n">RadiusOfGyration</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">,</span> <span class="n">protein</span><span class="p">,</span>
                          <span class="n">protein</span><span class="o">.</span><span class="n">masses</span><span class="p">,</span>
                          <span class="n">total_mass</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">protein</span><span class="o">.</span><span class="n">masses</span><span class="p">))</span>
<span class="n">rog_u1</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;MDAnalysis.analysis.base.analysis_class.&lt;locals&gt;.WrapperClass at 0x7f9000500820&gt;
</pre></div></div>
</div>
<p>As with <code class="docutils literal notranslate"><span class="pre">AnalysisFromFunction</span></code>, the results are in <code class="docutils literal notranslate"><span class="pre">results</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rog_u1</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;timeseries&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Radius of gyration (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frame&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;Frame&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_analysis_custom_trajectory_analysis_21_1.png" src="../../_images/examples_analysis_custom_trajectory_analysis_21_1.png" />
</div>
</div>
<p>You can reuse the class for other trajectories and selections.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ca</span> <span class="o">=</span> <span class="n">u2</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name CA&#39;</span><span class="p">)</span>

<span class="n">rog_u2</span> <span class="o">=</span> <span class="n">RadiusOfGyration</span><span class="p">(</span><span class="n">u2</span><span class="o">.</span><span class="n">trajectory</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span>
                          <span class="n">ca</span><span class="o">.</span><span class="n">masses</span><span class="p">,</span>
                          <span class="n">total_mass</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ca</span><span class="o">.</span><span class="n">masses</span><span class="p">))</span>
<span class="n">rog_u2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;MDAnalysis.analysis.base.analysis_class.&lt;locals&gt;.WrapperClass at 0x7f9000474df0&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rog_u2</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;timeseries&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Radius of gyration (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frame&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;Frame&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_analysis_custom_trajectory_analysis_24_1.png" src="../../_images/examples_analysis_custom_trajectory_analysis_24_1.png" />
</div>
</div>
</section>
<section id="Creating-your-own-class">
<h2>Creating your own class<a class="headerlink" href="#Creating-your-own-class" title="Link to this heading"></a></h2>
<p>Although <code class="docutils literal notranslate"><span class="pre">AnalysisFromFunction</span></code> and <code class="docutils literal notranslate"><span class="pre">analysis_class</span></code> are convenient, they can be too limited for complex algorithms. You may need to write your own class.</p>
<p>MDAnalysis provides the <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.base.AnalysisBase</span></code> class as a template for creating multiframe analyses. This class automatically sets up your trajectory reader for iterating, and includes an optional progress meter.</p>
<p>The analysis is always run by calling <code class="docutils literal notranslate"><span class="pre">run()</span></code>. <code class="docutils literal notranslate"><span class="pre">AnalysisFromFunction</span></code> actually subclasses <code class="docutils literal notranslate"><span class="pre">AnalysisBase</span></code>, and <code class="docutils literal notranslate"><span class="pre">analysis_class</span></code> returns a subclass of <code class="docutils literal notranslate"><span class="pre">AnalysisFromFunction</span></code>, so the behaviour of <code class="docutils literal notranslate"><span class="pre">run()</span></code> remains identical.</p>
<section id="1.-Define-__init__">
<h3>1. Define <code class="docutils literal notranslate"><span class="pre">__init__</span></code><a class="headerlink" href="#1.-Define-__init__" title="Link to this heading"></a></h3>
<p>You can define a new analysis by subclassing AnalysisBase. Initialise the analysis with the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method, where you <em>must</em> pass the trajectory that you are working with to <code class="docutils literal notranslate"><span class="pre">AnalysisBase.__init__()</span></code>. You can also pass in the <code class="docutils literal notranslate"><span class="pre">verbose</span></code> keyword. If <code class="docutils literal notranslate"><span class="pre">verbose=True</span></code>, the class will set up a progress meter for you.</p>
</section>
<section id="2.-Define-your-analysis-in-_single_frame()-and-other-methods">
<h3>2. Define your analysis in <code class="docutils literal notranslate"><span class="pre">_single_frame()</span></code> and other methods<a class="headerlink" href="#2.-Define-your-analysis-in-_single_frame()-and-other-methods" title="Link to this heading"></a></h3>
<p>Implement your functionality as a function over each frame of the trajectory by defining <code class="docutils literal notranslate"><span class="pre">_single_frame()</span></code>. This function gets called for each frame of your trajectory.</p>
<p>You can also define <code class="docutils literal notranslate"><span class="pre">_prepare()</span></code> and <code class="docutils literal notranslate"><span class="pre">_conclude()</span></code> to set your analysis up before looping over the trajectory, and to finalise the results that you have prepared. In order, <code class="docutils literal notranslate"><span class="pre">run()</span></code> calls:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_prepare()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_single_frame()</span></code> (for each frame of the trajectory that you are iterating over)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_conclude()</span></code></p></li>
</ul>
<p>Class subclassed from AnalysisBase can make use of several properties when defining the methods above:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self.start</span></code>: frame index to start analysing from. Defined in <code class="docutils literal notranslate"><span class="pre">run()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.stop</span></code>: frame index to stop analysis. Defined in <code class="docutils literal notranslate"><span class="pre">run()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.step</span></code>: number of frames to skip in between. Defined in <code class="docutils literal notranslate"><span class="pre">run()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.n_frames</span></code>: number of frames to analyse over. This can be helpful in initialising result arrays.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self._verbose</span></code>: whether to be verbose.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self._trajectory</span></code>: the actual trajectory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self._ts</span></code>: the current timestep object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self._frame_index</span></code>: the index of the currently analysed frame. This is <em>not</em> the absolute index of the frame in the trajectory overall, but rather the relative index of the frame within the list of frames to be analysed. You can think of it as the number of times that <code class="docutils literal notranslate"><span class="pre">self._single_frame()</span></code> has already been called.</p></li>
</ul>
<p>Below, we create the class <code class="docutils literal notranslate"><span class="pre">RadiusOfGyration2</span></code> to run the analysis function that we have defined above, and add extra information such as the time of the corresponding frame.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">RadiusOfGyration2</span><span class="p">(</span><span class="n">AnalysisBase</span><span class="p">):</span>  <span class="c1"># subclass AnalysisBase</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atomgroup</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set up the initial analysis parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># must first run AnalysisBase.__init__ and pass the trajectory</span>
        <span class="n">trajectory</span> <span class="o">=</span> <span class="n">atomgroup</span><span class="o">.</span><span class="n">universe</span><span class="o">.</span><span class="n">trajectory</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RadiusOfGyration2</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">trajectory</span><span class="p">,</span>
                                               <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="c1"># set atomgroup as a property for access in other methods</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atomgroup</span> <span class="o">=</span> <span class="n">atomgroup</span>
        <span class="c1"># we can calculate masses now because they do not depend</span>
        <span class="c1"># on the trajectory frame.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">masses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomgroup</span><span class="o">.</span><span class="n">masses</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masses</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create array of zeroes as a placeholder for results.</span>
<span class="sd">        This is run before we begin looping over the trajectory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># This must go here, instead of __init__, because</span>
        <span class="c1"># it depends on the number of frames specified in run().</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="c1"># We put in 6 columns: 1 for the frame index,</span>
        <span class="c1"># 1 for the time, 4 for the radii of gyration</span>

    <span class="k">def</span> <span class="nf">_single_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function is called for every frame that we choose</span>
<span class="sd">        in run().</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># call our earlier function</span>
        <span class="n">rogs</span> <span class="o">=</span> <span class="n">radgyr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomgroup</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">masses</span><span class="p">,</span>
                      <span class="n">total_mass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">total_mass</span><span class="p">)</span>
        <span class="c1"># save it into self.results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_frame_index</span><span class="p">,</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="n">rogs</span>
        <span class="c1"># the current timestep of the trajectory is self._ts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_frame_index</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ts</span><span class="o">.</span><span class="n">frame</span>
        <span class="c1"># the actual trajectory is at self._trajectory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_frame_index</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trajectory</span><span class="o">.</span><span class="n">time</span>

    <span class="k">def</span> <span class="nf">_conclude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finish up by calculating an average and transforming our</span>
<span class="sd">        results into a DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># by now self.result is fully populated</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">average</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frame&#39;</span><span class="p">,</span> <span class="s1">&#39;Time (ps)&#39;</span><span class="p">,</span> <span class="s1">&#39;Radius of Gyration&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Radius of Gyration (x-axis)&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Radius of Gyration (y-axis)&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Radius of Gyration (z-axis)&#39;</span><span class="p">,]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Because <code class="docutils literal notranslate"><span class="pre">RadiusOfGyration2</span></code> calculates the masses of the selected AtomGroup itself, we do not need to pass it in ourselves.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rog_base</span> <span class="o">=</span> <span class="n">RadiusOfGyration2</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "504e4004c0f94406b0b62f17d4ae0b07", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>As calculated in <code class="docutils literal notranslate"><span class="pre">_conclude()</span></code>, the average radii of gyrations are at <code class="docutils literal notranslate"><span class="pre">rog.average</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rog_base</span><span class="o">.</span><span class="n">average</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([18.26549552, 12.85342131, 15.37359575, 16.29185734])
</pre></div></div>
</div>
<p>The results are available at <code class="docutils literal notranslate"><span class="pre">rog.results</span></code> as an array or <code class="docutils literal notranslate"><span class="pre">rog.df</span></code> as a DataFrame.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rog_base</span><span class="o">.</span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frame</th>
      <th>Time (ps)</th>
      <th>Radius of Gyration</th>
      <th>Radius of Gyration (x-axis)</th>
      <th>Radius of Gyration (y-axis)</th>
      <th>Radius of Gyration (z-axis)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1.000000</td>
      <td>16.669018</td>
      <td>12.679625</td>
      <td>13.749343</td>
      <td>14.349043</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>2.000000</td>
      <td>16.673217</td>
      <td>12.640025</td>
      <td>13.760545</td>
      <td>14.382960</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>3.000000</td>
      <td>16.731454</td>
      <td>12.696454</td>
      <td>13.801342</td>
      <td>14.429350</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>4.000000</td>
      <td>16.722283</td>
      <td>12.677194</td>
      <td>13.780732</td>
      <td>14.444711</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.0</td>
      <td>5.000000</td>
      <td>16.743961</td>
      <td>12.646981</td>
      <td>13.814553</td>
      <td>14.489046</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>93</th>
      <td>93.0</td>
      <td>93.999992</td>
      <td>19.562034</td>
      <td>13.421683</td>
      <td>16.539112</td>
      <td>17.653968</td>
    </tr>
    <tr>
      <th>94</th>
      <td>94.0</td>
      <td>94.999992</td>
      <td>19.560575</td>
      <td>13.451335</td>
      <td>16.508649</td>
      <td>17.656678</td>
    </tr>
    <tr>
      <th>95</th>
      <td>95.0</td>
      <td>95.999992</td>
      <td>19.550571</td>
      <td>13.445914</td>
      <td>16.500640</td>
      <td>17.646130</td>
    </tr>
    <tr>
      <th>96</th>
      <td>96.0</td>
      <td>96.999991</td>
      <td>19.568381</td>
      <td>13.443243</td>
      <td>16.507396</td>
      <td>17.681294</td>
    </tr>
    <tr>
      <th>97</th>
      <td>97.0</td>
      <td>97.999991</td>
      <td>19.591575</td>
      <td>13.442750</td>
      <td>16.537926</td>
      <td>17.704494</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 6 columns</p>
</div></div>
</div>
<p>Using this DataFrame we can easily plot our results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">rog_base</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Time (ps)&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">rog_base</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Radius of gyration (A)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Radius of gyration (A)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_analysis_custom_trajectory_analysis_34_1.png" src="../../_images/examples_analysis_custom_trajectory_analysis_34_1.png" />
</div>
</div>
<p>We can also run the analysis over a subset of frames, the same as the output from <code class="docutils literal notranslate"><span class="pre">AnalysisFromFunction</span></code> and <code class="docutils literal notranslate"><span class="pre">analysis_class</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rog_base_10</span> <span class="o">=</span> <span class="n">RadiusOfGyration2</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rog_base_10</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b8fc6d3e50df475fa82e4bcf1046a117", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;__main__.RadiusOfGyration2 at 0x7f90006ca9d0&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rog_base_10</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(10, 6)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rog_base_10</span><span class="o">.</span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frame</th>
      <th>Time (ps)</th>
      <th>Radius of Gyration</th>
      <th>Radius of Gyration (x-axis)</th>
      <th>Radius of Gyration (y-axis)</th>
      <th>Radius of Gyration (z-axis)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10.0</td>
      <td>10.999999</td>
      <td>16.852127</td>
      <td>12.584163</td>
      <td>14.001589</td>
      <td>14.614469</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17.0</td>
      <td>17.999998</td>
      <td>17.019587</td>
      <td>12.544784</td>
      <td>14.163276</td>
      <td>14.878262</td>
    </tr>
    <tr>
      <th>2</th>
      <td>24.0</td>
      <td>24.999998</td>
      <td>17.257429</td>
      <td>12.514341</td>
      <td>14.487021</td>
      <td>15.137873</td>
    </tr>
    <tr>
      <th>3</th>
      <td>31.0</td>
      <td>31.999997</td>
      <td>17.542565</td>
      <td>12.522147</td>
      <td>14.747461</td>
      <td>15.530339</td>
    </tr>
    <tr>
      <th>4</th>
      <td>38.0</td>
      <td>38.999997</td>
      <td>17.871241</td>
      <td>12.482385</td>
      <td>15.088865</td>
      <td>15.977444</td>
    </tr>
    <tr>
      <th>5</th>
      <td>45.0</td>
      <td>45.999996</td>
      <td>18.182243</td>
      <td>12.533023</td>
      <td>15.451285</td>
      <td>16.290153</td>
    </tr>
    <tr>
      <th>6</th>
      <td>52.0</td>
      <td>52.999995</td>
      <td>18.496493</td>
      <td>12.771949</td>
      <td>15.667003</td>
      <td>16.603098</td>
    </tr>
    <tr>
      <th>7</th>
      <td>59.0</td>
      <td>59.999995</td>
      <td>18.839346</td>
      <td>13.037335</td>
      <td>15.900327</td>
      <td>16.942533</td>
    </tr>
    <tr>
      <th>8</th>
      <td>66.0</td>
      <td>66.999994</td>
      <td>19.064333</td>
      <td>13.061491</td>
      <td>16.114195</td>
      <td>17.222884</td>
    </tr>
    <tr>
      <th>9</th>
      <td>73.0</td>
      <td>73.999993</td>
      <td>19.276639</td>
      <td>13.161863</td>
      <td>16.298539</td>
      <td>17.444213</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax_10</span> <span class="o">=</span> <span class="n">rog_base_10</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Time (ps)&#39;</span><span class="p">,</span>
                            <span class="n">y</span><span class="o">=</span><span class="n">rog_base_10</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
<span class="n">ax_10</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Radius of gyration (A)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Radius of gyration (A)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_analysis_custom_trajectory_analysis_39_1.png" src="../../_images/examples_analysis_custom_trajectory_analysis_39_1.png" />
</div>
</div>
</section>
</section>
<section id="Contributing-to-MDAnalysis">
<h2>Contributing to MDAnalysis<a class="headerlink" href="#Contributing-to-MDAnalysis" title="Link to this heading"></a></h2>
<p>If you think that you will want to reuse your new analysis, or that others might find it helpful, please consider <a class="reference external" href="https://www.mdanalysis.org/UserGuide/contributing.html">contributing it to the MDAnalysis codebase.</a> Making your code open-source can have many benefits; others may notice an unexpected bug or suggest ways to optimise your code. If you write your analysis for a specific publication, please let us know; we will ask those who use your code to cite your reference in published work.</p>
</section>
<section id="References">
<h2>References<a class="headerlink" href="#References" title="Link to this heading"></a></h2>
<p>[1] Oliver Beckstein, Elizabeth J. Denning, Juan R. Perilla, and Thomas B. Woolf. Zipping and Unzipping of Adenylate Kinase: Atomistic Insights into the Ensemble of Open↔Closed Transitions. Journal of Molecular Biology, 394(1):160–176, November 2009. 00107. URL: <a class="reference external" href="https://linkinghub.elsevier.com/retrieve/pii/S0022283609011164">https://linkinghub.elsevier.com/retrieve/pii/S0022283609011164</a>, doi:10.1016/j.jmb.2009.09.009.</p>
<p>[2] Richard J. Gowers, Max Linke, Jonathan Barnoud, Tyler J. E. Reddy, Manuel N. Melo, Sean L. Seyler, Jan Domański, David L. Dotson, Sébastien Buchoux, Ian M. Kenney, and Oliver Beckstein. MDAnalysis: A Python Package for the Rapid Analysis of Molecular Dynamics Simulations. Proceedings of the 15th Python in Science Conference, pages 98–105, 2016. 00152. URL: <a class="reference external" href="https://conference.scipy.org/proceedings/scipy2016/oliver_beckstein.html">https://conference.scipy.org/proceedings/scipy2016/oliver_beckstein.html</a>, doi:10.25080/Majora-629e541a-00e.</p>
<p>[3] Naveen Michaud-Agrawal, Elizabeth J. Denning, Thomas B. Woolf, and Oliver Beckstein. MDAnalysis: A toolkit for the analysis of molecular dynamics simulations. Journal of Computational Chemistry, 32(10):2319–2327, July 2011. 00778. URL: <a class="reference external" href="http://doi.wiley.com/10.1002/jcc.21787">http://doi.wiley.com/10.1002/jcc.21787</a>, doi:10.1002/jcc.21787.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hydrogen_bonds/hbonds-lifetimes.html" class="btn btn-neutral float-left" title="Calculating hydrogen bond lifetimes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="custom_parallel_analysis.html" class="btn btn-neutral float-right" title="Parallelizing analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2023, Lily Wang, Irfan Alibay, Patricio Barletta, Cédric Bouysset, Jan Domanski, Bjarne Feddersen, Florent Langenfeld, Hugo MacDermott-Opeskin, Rocco Meli, Paul Smith, Mieczyslaw Torchala, Mark Verma, Yuxuan Zhuang, Richard J. Gowers, and Oliver Beckstein..</p>
  </div>

  
 
<div class="footer"><p>Please see
    our <a href="https://www.mdanalysis.org/pages/privacy/">Privacy Policy</a>
    to learn how <a href="https://www.mdanalysis.org">MDAnalysis</a> collects data.</p>
    <script data-goatcounter="https://mdanalysis.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
</div>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
    var versions_json_url = 'https://userguide.mdanalysis.org/versions.json'
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>