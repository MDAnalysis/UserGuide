


  
    
  




<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css" integrity="sha512-b1ASx0WHgVFL5ZQhTgiPWX+68KjS38Jk87jg7pe+qC7q9YkEtFq0z7xCglv7qGIs/68d3mAp+StfC8WKC5SSAg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="shortcut icon" href="../../../_static/logo/mda_favicon.ico">
</head>

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calculating the root mean square deviation of atomic structures &mdash; MDAnalysis User Guide  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/site.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/nbsphinx-code-cells.css" type="text/css" />
    <link rel="canonical" href="https://userguide.mdanalysis.org/examples/analysis/alignment_and_rms/rmsd.html" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="../../../_static/js/versions.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis User Guide  documentation"
          href="../../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Calculating the pairwise RMSD of a trajectory" href="pairwise_rmsd.html" />
    <link rel="prev" title="Aligning a trajectory to itself" href="aligning_trajectory_to_frame.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >




  




<a href="../../../index.html">
  
    <img src="../../../_static/user_guide.png" class="logo" alt="Logo"/>
</a>


  
  
  
    <div class="version">
      2.7.0-dev0
    </div>
  



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div>
<div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
    <!-- <p class="caption" role="heading"></p> -->
    <ul>
        
        <li class="toctree-l1"><a class="reference internal" href="https://mdanalysis.org">MDAnalysis</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="https://docs.mdanalysis.org/stable">API docs (stable)</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="https://docs.mdanalysis.org/dev">API docs (development)</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="https://mdakits.mdanalysis.org/">MDAKits</a></li>
        
    </ul>
    
        <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">Frequently asked questions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../README.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../quickstart.html">Quick start guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../constructing_universe.html">Constructing, modifying, and adding to a Universe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../transformations/README.html">Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other/README.html">Other</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="README.html">Alignments and RMS fitting</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="aligning_structure_to_another.html">Aligning a structure to another</a></li>
<li class="toctree-l3"><a class="reference internal" href="aligning_trajectory.html">Aligning a trajectory to a reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="aligning_trajectory_to_frame.html">Aligning a trajectory to itself</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Calculating the root mean square deviation of atomic structures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Loading-files">Loading files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Background">Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="#RMSD-between-two-sets-of-coordinates">RMSD between two sets of coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#RMSD-of-a-Universe-with-multiple-selections">RMSD of a Universe with multiple selections</a></li>
<li class="toctree-l4"><a class="reference internal" href="#RMSD-of-an-AtomGroup-with-multiple-selections">RMSD of an AtomGroup with multiple selections</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Weighted-RMSD-of-a-trajectory">Weighted RMSD of a trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pairwise_rmsd.html">Calculating the pairwise RMSD of a trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="rmsf.html">Calculating the root mean square fluctuation over a trajectory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../distances_and_contacts/README.html">Distances and contacts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trajectory_similarity/README.html">Trajectory similarity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../structure/README.html">Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reduced_dimensions/README.html">Dimension reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polymers_and_membranes/README.html">Polymers and membranes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../volumetric/README.html">Volumetric analyses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../releases.html">MDAnalysis Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data structures</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../universe.html">Universe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../atomgroup.html">AtomGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../groups_of_atoms.html">Groups of atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../selections.html">Atom selection language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../topology_system.html">The topology system</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Trajectories</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../trajectories/trajectories.html">Trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trajectories/slicing_trajectories.html">Slicing trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trajectories/transformations.html">On-the-fly transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../units.html">Units and constants</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Input/output</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reading_and_writing.html">Reading and writing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../formats/index.html">Format overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../formats/guessing.html">Guessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../formats/auxiliary.html">Auxiliary files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../formats/selection_exporters.html">Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../formats/format_reference.html">Format reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#alignments-and-rms-fitting">Alignments and RMS fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#distances-and-contacts">Distances and contacts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#trajectory-similarity">Trajectory similarity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#structure">Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#volumetric-analyses">Volumetric analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#dimension-reduction">Dimension reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#polymers-and-membranes">Polymers and membranes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#hydrogen-bond-analysis">Hydrogen Bond Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../custom_trajectory_analysis.html">Writing your own trajectory analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../custom_parallel_analysis.html">Parallelizing analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../standard_selections.html">Standard residues in MDAnalysis selections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../advanced_topology.html">Advanced topology concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../datasets.html">Example data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing to MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing_code.html">Contributing to the main codebase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing_docs.html">Contributing to the user guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../preparing_releases_and_hotfixes.html">Preparing a release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../module_imports.html">Module imports in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../testing.html">Tests in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">References</a></li>
</ul>

</div>

      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MDAnalysis User Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../README.html">Examples</a></li>
          <li class="breadcrumb-item"><a href="README.html">Alignments and RMS fitting</a></li>
      <li class="breadcrumb-item active">Calculating the root mean square deviation of atomic structures</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/examples/analysis/alignment_and_rms/rmsd.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <script src="http://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script>require=requirejs;</script><section id="Calculating-the-root-mean-square-deviation-of-atomic-structures">
<h1>Calculating the root mean square deviation of atomic structures<a class="headerlink" href="#Calculating-the-root-mean-square-deviation-of-atomic-structures" title="Permalink to this heading"></a></h1>
<p>We calculate the RMSD of domains in adenylate kinase as it transitions from an open to closed structure, and look at calculating weighted RMSDs.</p>
<p><strong>Last updated:</strong> December 2022 with MDAnalysis 2.4.0-dev0</p>
<p><strong>Minimum version of MDAnalysis:</strong> 1.0.0</p>
<p><strong>Packages required:</strong></p>
<ul class="simple">
<li><p>MDAnalysis (<span id="id1">[<a class="reference internal" href="../../../references.html#id11" title="Naveen Michaud-Agrawal, Elizabeth J. Denning, Thomas B. Woolf, and Oliver Beckstein. MDAnalysis: A toolkit for the analysis of molecular dynamics simulations. Journal of Computational Chemistry, 32(10):2319–2327, July 2011. 00778. URL: http://doi.wiley.com/10.1002/jcc.21787 (visited on 2020-02-05), doi:10.1002/jcc.21787.">MADWB11</a>]</span>, <span id="id2">[<a class="reference internal" href="../../../references.html#id3" title="Richard J. Gowers, Max Linke, Jonathan Barnoud, Tyler J. E. Reddy, Manuel N. Melo, Sean L. Seyler, Jan Domański, David L. Dotson, Sébastien Buchoux, Ian M. Kenney, and Oliver Beckstein. MDAnalysis: A Python Package for the Rapid Analysis of Molecular Dynamics Simulations. Proceedings of the 15th Python in Science Conference, pages 98–105, 2016. 00152. URL: https://conference.scipy.org/proceedings/scipy2016/oliver_beckstein.html (visited on 2020-02-05), doi:10.25080/Majora-629e541a-00e.">GLB+16</a>]</span>)</p></li>
<li><p>MDAnalysisTests</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org">pandas</a></p></li>
</ul>
<p><strong>See also</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="pairwise_rmsd.html"><span class="doc">Pairwise (2D) RMSD</span></a></p></li>
<li><p><a class="reference internal" href="rmsf.html"><span class="doc">RMSF</span></a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title"><strong>Note</strong></p>
<p>MDAnalysis implements RMSD calculation using the fast QCP algorithm (<span id="id3">[<a class="reference internal" href="../../../references.html#id10" title="Douglas L. Theobald. Rapid calculation of RMSDs using a quaternion-based characteristic polynomial. Acta Crystallographica Section A Foundations of Crystallography, 61(4):478–480, July 2005. 00127. URL: http://scripts.iucr.org/cgi-bin/paper?S0108767305015266 (visited on 2020-02-05), doi:10.1107/S0108767305015266.">The05</a>]</span>). Please cite (<span id="id4">[<a class="reference internal" href="../../../references.html#id10" title="Douglas L. Theobald. Rapid calculation of RMSDs using a quaternion-based characteristic polynomial. Acta Crystallographica Section A Foundations of Crystallography, 61(4):478–480, July 2005. 00127. URL: http://scripts.iucr.org/cgi-bin/paper?S0108767305015266 (visited on 2020-02-05), doi:10.1107/S0108767305015266.">The05</a>]</span>) when using the <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.align</span></code> module in published work.</p>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">PSF</span><span class="p">,</span> <span class="n">DCD</span><span class="p">,</span> <span class="n">CRD</span>
<span class="kn">from</span> <span class="nn">MDAnalysis.analysis</span> <span class="kn">import</span> <span class="n">rms</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># the next line is necessary to display plots in Jupyter</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<section id="Loading-files">
<h2>Loading files<a class="headerlink" href="#Loading-files" title="Permalink to this heading"></a></h2>
<p>The test files we will be working with here feature adenylate kinase (AdK), a phosophotransferase enzyme. (<span id="id5">[<a class="reference internal" href="../../../references.html#id14" title="Oliver Beckstein, Elizabeth J. Denning, Juan R. Perilla, and Thomas B. Woolf. Zipping and Unzipping of Adenylate Kinase: Atomistic Insights into the Ensemble of Open↔Closed Transitions. Journal of Molecular Biology, 394(1):160–176, November 2009. 00107. URL: https://linkinghub.elsevier.com/retrieve/pii/S0022283609011164 (visited on 2020-02-05), doi:10.1016/j.jmb.2009.09.009.">BDPW09</a>]</span>) The trajectory <code class="docutils literal notranslate"><span class="pre">DCD</span></code> samples a transition from a closed to an open conformation. AdK has three domains:</p>
<ul class="simple">
<li><p>CORE</p></li>
<li><p>LID: an ATP-binding domain</p></li>
<li><p>NMP: an AMP-binding domain</p></li>
</ul>
<p>The LID and NMP domains move around the stable CORE as the enzyme transitions between the opened and closed conformations. One way to quantify this movement is by calculating the root mean square deviation (RMSD) of atomic positions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PSF</span><span class="p">,</span> <span class="n">DCD</span><span class="p">)</span>  <span class="c1"># closed AdK (PDB ID: 1AKE)</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PSF</span><span class="p">,</span> <span class="n">CRD</span><span class="p">)</span>  <span class="c1"># open AdK (PDB ID: 4AKE)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/pbarletta/mambaforge/envs/guide/lib/python3.9/site-packages/MDAnalysis/coordinates/DCD.py:165: DeprecationWarning: DCDReader currently makes independent timesteps by copying self.ts while other readers update self.ts inplace. This behavior will be changed in 3.0 to be the same as other readers. Read more at https://github.com/MDAnalysis/mdanalysis/issues/3889 to learn if this change in behavior might affect you.
  warnings.warn(&#34;DCDReader currently makes independent timesteps&#34;
</pre></div></div>
</div>
</section>
<section id="Background">
<h2>Background<a class="headerlink" href="#Background" title="Permalink to this heading"></a></h2>
<p>The root mean square deviation (RMSD) of particle coordinates is one measure of distance, or dissimilarity, between molecular conformations. Each structure should have matching elementwise atoms <span class="math notranslate nohighlight">\(i\)</span> in the same order, as the distance between them is calculated and summed for the final result. It is calculated between coordinate arrays <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x}^{\text{ref}}\)</span> according to the equation below:</p>
<div class="math notranslate nohighlight">
\[\text{RMSD}(\mathbf{x}, \mathbf{x}^{\text{ref}}) = \sqrt{\frac{1}{n} \sum_{i=1}^{n}{|\mathbf{x}_i-\mathbf{x}_i^{\text{ref}}|^2}}\]</div>
<p>As molecules can move around, the structure <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is usually translated by a vector <span class="math notranslate nohighlight">\(\mathbf{t}\)</span> and rotated by a matrix <span class="math notranslate nohighlight">\(\mathsf{R}\)</span> to align with the reference <span class="math notranslate nohighlight">\(\mathbf{x}^{\text{ref}}\)</span> such that the RMSD is minimised. The RMSD after this optimal superposition can be expressed as follows:</p>
<div class="math notranslate nohighlight">
\[\text{RMSD}(\mathbf{x}, \mathbf{x}^{\text{ref}}) = \min_{\mathsf{R}, \mathbf{t}} %
 \sqrt{\frac{1}{N} \sum_{i=1}^{N} \left[ %
     (\mathsf{R}\cdot\mathbf{x}_{i}(t) + \mathbf{t}) - \mathbf{x}_{i}^{\text{ref}} \right]^{2}}\]</div>
<p>The RMSD between one reference state and a trajectory of structures is often calculated as a way to measure the dissimilarity of the trajectory conformational ensemble to the reference. This reference is frequently the first frame of the trajectory (the default in MDAnalysis), in which case it can provide insight into the overall movement from the initial starting point. While stable RMSD values from a reference structure are frequently used as a measure of conformational convergence, this
metric suffers from the problem of <em>degeneracy</em>: many different structures can have the same RMSD from the same reference. For an alternative measure, you could use <a class="reference internal" href="pairwise_rmsd.html"><span class="doc">pairwise or 2D RMSD</span></a>.</p>
<p>Typically not all coordinates in a structures are included in an RMSD analysis. With proteins, the fluctuation of the residue side-chains is not representative of overall conformational change. Therefore when RMSD analyses are performed to investigate large-scale movements in proteins, the atoms are usually restricted only to the backbone atoms (forming the amide-bond chain) or the alpha-carbon atoms.</p>
<p>MDAnalysis provides functions and classes to calculate the <a class="reference internal" href="#RMSD-between-two-sets-of-coordinates"><span class="std std-ref">RMSD between coordinate arrays</span></a>, and <a class="reference internal" href="#RMSD-of-a-Universe-with-multiple-selections"><span class="std std-ref">Universes</span></a> or <a class="reference internal" href="#RMSD-of-an-AtomGroup-with-multiple-selections"><span class="std std-ref">AtomGroups</span></a>.</p>
<p>The contribution of each particle <span class="math notranslate nohighlight">\(i\)</span> to the final RMSD value can also <a class="reference internal" href="#Weighted-RMSD-of-a-trajectory"><span class="std std-ref">be weighted</span></a> by <span class="math notranslate nohighlight">\(w_i\)</span>:</p>
<div class="math notranslate nohighlight">
\[\text{RMSD}(\mathbf{x}, \mathbf{x}^\text{ref}) = \sqrt{\frac{\sum_{i=1}^{n}{w_i|\mathbf{x}_i-\mathbf{x}_i^{\text{ref}}|^2}}{\sum_{i-1}^n w_i}}\]</div>
<p>RMSD analyses are frequently weighted by mass. The MDAnalysis RMSD class (<a class="reference external" href="https://docs.mdanalysis.org/stable/documentation_pages/analysis/rms.html#MDAnalysis.analysis.rms.RMSD">API docs</a>) allows you to both <a class="reference internal" href="#Mass"><span class="std std-ref">select mass-weighting</span></a> with <code class="docutils literal notranslate"><span class="pre">weights='mass'</span></code> or <code class="docutils literal notranslate"><span class="pre">weights_groupselections='mass'</span></code>, or to <a class="reference internal" href="#Custom-weights"><span class="std std-ref">pass custom arrays</span></a> into either keyword.</p>
</section>
<section id="RMSD-between-two-sets-of-coordinates">
<h2>RMSD between two sets of coordinates<a class="headerlink" href="#RMSD-between-two-sets-of-coordinates" title="Permalink to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.rms.rmsd</span></code> function returns the root mean square deviation (in Angstrom) between two sets of coordinates. Here, we calculate the RMSD between the backbone atoms of the open and closed conformations of AdK. Only considering the backbone atoms is often more helpful than calculating the RMSD for all the atoms, as movement in amino acid side-chains isn’t indicative of overall conformational change.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rms</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;backbone&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span>  <span class="c1"># coordinates to align</span>
         <span class="n">ref</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;backbone&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span>  <span class="c1"># reference coordinates</span>
         <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># subtract the center of geometry</span>
         <span class="n">superposition</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># superimpose coordinates</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
6.823686867261616
</pre></div></div>
</div>
</section>
<section id="RMSD-of-a-Universe-with-multiple-selections">
<h2>RMSD of a Universe with multiple selections<a class="headerlink" href="#RMSD-of-a-Universe-with-multiple-selections" title="Permalink to this heading"></a></h2>
<p>It is more efficient to use the <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.rms.RMSD</span></code> class to calculate the RMSD of an entire trajectory to a single reference point, than to use the the <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.rms.rmsd</span></code> function.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">rms.RMSD</span></code> class first performs a rotational and translational alignment of the target trajectory to the reference universe at <code class="docutils literal notranslate"><span class="pre">ref_frame</span></code>, using the atoms in <code class="docutils literal notranslate"><span class="pre">select</span></code> to determine the transformation. The RMSD of the <code class="docutils literal notranslate"><span class="pre">select</span></code> selection is calculated. Then, <em>without further alignment</em>, the RMSD of each group in <code class="docutils literal notranslate"><span class="pre">groupselections</span></code> is calculated.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CORE</span> <span class="o">=</span> <span class="s1">&#39;backbone and (resid 1-29 or resid 60-121 or resid 160-214)&#39;</span>
<span class="n">LID</span> <span class="o">=</span> <span class="s1">&#39;backbone and resid 122-159&#39;</span>
<span class="n">NMP</span> <span class="o">=</span> <span class="s1">&#39;backbone and resid 30-59&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="n">rms</span><span class="o">.</span><span class="n">RMSD</span><span class="p">(</span><span class="n">u</span><span class="p">,</span>  <span class="c1"># universe to align</span>
             <span class="n">u</span><span class="p">,</span>  <span class="c1"># reference universe or atomgroup</span>
             <span class="n">select</span><span class="o">=</span><span class="s1">&#39;backbone&#39;</span><span class="p">,</span>  <span class="c1"># group to superimpose and calculate RMSD</span>
             <span class="n">groupselections</span><span class="o">=</span><span class="p">[</span><span class="n">CORE</span><span class="p">,</span> <span class="n">LID</span><span class="p">,</span> <span class="n">NMP</span><span class="p">],</span>  <span class="c1"># groups for RMSD</span>
             <span class="n">ref_frame</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># frame index of the reference</span>
<span class="n">R</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;MDAnalysis.analysis.rms.RMSD at 0x7f2e830164f0&gt;
</pre></div></div>
</div>
<p>The data is saved in <code class="docutils literal notranslate"><span class="pre">R.rmsd</span></code> as an array.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">rmsd</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(98, 6)
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">R.rmsd</span></code> has a row for each timestep. The first two columns of each row are the frame index of the time step, and the time (which is guessed in trajectory formats without timesteps). The third column is RMSD of <code class="docutils literal notranslate"><span class="pre">select</span></code>. The last few columns are the RMSD of the groups in <code class="docutils literal notranslate"><span class="pre">groupselections</span></code>.</p>
<section id="Plotting-the-data">
<h3>Plotting the data<a class="headerlink" href="#Plotting-the-data" title="Permalink to this heading"></a></h3>
<p>We can easily plot this data using the common data analysis package <a class="reference external" href="https://pandas.pydata.org">pandas</a>. We turn the <code class="docutils literal notranslate"><span class="pre">R.rmsd</span></code> array into a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/getting_started/dsintro.html#dataframe">DataFrame</a> and label each column below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">rmsd</span><span class="p">,</span>
                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Frame&#39;</span><span class="p">,</span> <span class="s1">&#39;Time (ns)&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Backbone&#39;</span><span class="p">,</span> <span class="s1">&#39;CORE&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;LID&#39;</span><span class="p">,</span> <span class="s1">&#39;NMP&#39;</span><span class="p">])</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frame</th>
      <th>Time (ns)</th>
      <th>Backbone</th>
      <th>CORE</th>
      <th>LID</th>
      <th>NMP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1.000000</td>
      <td>5.834344e-07</td>
      <td>3.921486e-08</td>
      <td>1.197000e-07</td>
      <td>6.276497e-08</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>2.000000</td>
      <td>4.636592e-01</td>
      <td>4.550181e-01</td>
      <td>4.871915e-01</td>
      <td>4.745572e-01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>3.000000</td>
      <td>6.419340e-01</td>
      <td>5.754418e-01</td>
      <td>7.940994e-01</td>
      <td>7.270191e-01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>4.000000</td>
      <td>7.743983e-01</td>
      <td>6.739184e-01</td>
      <td>1.010261e+00</td>
      <td>8.795031e-01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.0</td>
      <td>5.000000</td>
      <td>8.588600e-01</td>
      <td>7.318859e-01</td>
      <td>1.168397e+00</td>
      <td>9.612989e-01</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>93</th>
      <td>93.0</td>
      <td>93.999992</td>
      <td>6.817898e+00</td>
      <td>3.504430e+00</td>
      <td>1.143376e+01</td>
      <td>1.029266e+01</td>
    </tr>
    <tr>
      <th>94</th>
      <td>94.0</td>
      <td>94.999992</td>
      <td>6.804211e+00</td>
      <td>3.480681e+00</td>
      <td>1.141134e+01</td>
      <td>1.029879e+01</td>
    </tr>
    <tr>
      <th>95</th>
      <td>95.0</td>
      <td>95.999992</td>
      <td>6.807987e+00</td>
      <td>3.508946e+00</td>
      <td>1.137593e+01</td>
      <td>1.031958e+01</td>
    </tr>
    <tr>
      <th>96</th>
      <td>96.0</td>
      <td>96.999991</td>
      <td>6.821205e+00</td>
      <td>3.498081e+00</td>
      <td>1.139156e+01</td>
      <td>1.037768e+01</td>
    </tr>
    <tr>
      <th>97</th>
      <td>97.0</td>
      <td>97.999991</td>
      <td>6.820322e+00</td>
      <td>3.507119e+00</td>
      <td>1.138474e+01</td>
      <td>1.036821e+01</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 6 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Frame&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Backbone&#39;</span><span class="p">,</span> <span class="s1">&#39;CORE&#39;</span><span class="p">,</span> <span class="s1">&#39;LID&#39;</span><span class="p">,</span> <span class="s1">&#39;NMP&#39;</span><span class="p">],</span>
             <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;RMSD ($\AA$)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;RMSD ($\\AA$)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_analysis_alignment_and_rms_rmsd_18_1.png" src="../../../_images/examples_analysis_alignment_and_rms_rmsd_18_1.png" />
</div>
</div>
</section>
</section>
<section id="RMSD-of-an-AtomGroup-with-multiple-selections">
<h2>RMSD of an AtomGroup with multiple selections<a class="headerlink" href="#RMSD-of-an-AtomGroup-with-multiple-selections" title="Permalink to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">RMSD</span></code> class accepts both <code class="docutils literal notranslate"><span class="pre">AtomGroup</span></code>s and <code class="docutils literal notranslate"><span class="pre">Universe</span></code>s as arguments. Restricting the atoms considered to an AtomGroup can be very helpful, as the <code class="docutils literal notranslate"><span class="pre">select</span></code> and <code class="docutils literal notranslate"><span class="pre">groupselections</span></code> arguments are applied only to the atoms in the original <code class="docutils literal notranslate"><span class="pre">AtomGroup</span></code>. In the example below, for example, only the alpha-carbons of the CORE domain are incorporated in the analysis.</p>
<div class="admonition note">
<p class="admonition-title"><strong>Note</strong></p>
<p>This feature does not currently support <code class="docutils literal notranslate"><span class="pre">groupselections</span></code>.</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ca</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name CA&#39;</span><span class="p">)</span>

<span class="n">R</span> <span class="o">=</span> <span class="n">rms</span><span class="o">.</span><span class="n">RMSD</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="n">CORE</span><span class="p">,</span> <span class="n">ref_frame</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">R</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;MDAnalysis.analysis.rms.RMSD at 0x7f2e80561610&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">rmsd</span><span class="p">,</span>
                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Frame&#39;</span><span class="p">,</span> <span class="s1">&#39;Time (ns)&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;CORE&#39;</span><span class="p">])</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Frame&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CORE&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;RMSD ($\AA$)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;RMSD ($\\AA$)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_analysis_alignment_and_rms_rmsd_21_1.png" src="../../../_images/examples_analysis_alignment_and_rms_rmsd_21_1.png" />
</div>
</div>
</section>
<section id="Weighted-RMSD-of-a-trajectory">
<h2>Weighted RMSD of a trajectory<a class="headerlink" href="#Weighted-RMSD-of-a-trajectory" title="Permalink to this heading"></a></h2>
<p>You can also calculate the weighted RMSD of a trajectory using the <code class="docutils literal notranslate"><span class="pre">weights</span></code> and <code class="docutils literal notranslate"><span class="pre">weights_groupselections</span></code> keywords. The former only applies weights to the group in <code class="docutils literal notranslate"><span class="pre">select</span></code>, while the latter must be a list of the <em>same length and order</em> as <code class="docutils literal notranslate"><span class="pre">groupselections</span></code>. If you would like to only weight certain groups in <code class="docutils literal notranslate"><span class="pre">groupselections</span></code>, use <code class="docutils literal notranslate"><span class="pre">None</span></code> for the unweighted groups. Both <code class="docutils literal notranslate"><span class="pre">weights</span></code> and <code class="docutils literal notranslate"><span class="pre">weights_groupselections</span></code> accept <code class="docutils literal notranslate"><span class="pre">None</span></code> (for unweighted), <code class="docutils literal notranslate"><span class="pre">'mass'</span></code> (to weight by mass), and
custom arrays. A custom array should have the same number of values as there are particles in the corresponding AtomGroup.</p>
<section id="Mass">
<h3>Mass<a class="headerlink" href="#Mass" title="Permalink to this heading"></a></h3>
<p>It is common to weight RMSD analyses by particle weight, so the <code class="docutils literal notranslate"><span class="pre">RMSD</span></code> class accepts <code class="docutils literal notranslate"><span class="pre">'mass'</span></code> as an argument for <code class="docutils literal notranslate"><span class="pre">weights</span></code>. Note that the <code class="docutils literal notranslate"><span class="pre">weights</span></code> keyword only applies to the group in <code class="docutils literal notranslate"><span class="pre">select</span></code>, and does not apply to the <code class="docutils literal notranslate"><span class="pre">groupselections</span></code>; these remain unweighted below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R_mass</span> <span class="o">=</span> <span class="n">rms</span><span class="o">.</span><span class="n">RMSD</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span>
                  <span class="n">select</span><span class="o">=</span><span class="s1">&#39;protein and name CA&#39;</span><span class="p">,</span>
                  <span class="n">weights</span><span class="o">=</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span>
                  <span class="n">groupselections</span><span class="o">=</span><span class="p">[</span><span class="n">CORE</span><span class="p">,</span> <span class="n">LID</span><span class="p">,</span> <span class="n">NMP</span><span class="p">])</span>
<span class="n">R_mass</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;MDAnalysis.analysis.rms.RMSD at 0x7f2e804833d0&gt;
</pre></div></div>
</div>
<p>The plot looks largely the same as above because all the alpha-carbons and individual backbone atoms have the same mass. Below we show how you can pass in custom weights.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mass</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">R_mass</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">rmsd</span><span class="p">,</span>
                       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Frame&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;Time (ns)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;C-alphas&#39;</span><span class="p">,</span> <span class="s1">&#39;CORE&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;LID&#39;</span><span class="p">,</span> <span class="s1">&#39;NMP&#39;</span><span class="p">])</span>
<span class="n">ax_mass</span> <span class="o">=</span> <span class="n">df_mass</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Frame&#39;</span><span class="p">,</span>
                       <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C-alphas&#39;</span><span class="p">,</span> <span class="s1">&#39;CORE&#39;</span><span class="p">,</span> <span class="s1">&#39;LID&#39;</span><span class="p">,</span> <span class="s1">&#39;NMP&#39;</span><span class="p">])</span>
<span class="n">ax_mass</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mass-weighted RMSD ($\AA$)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Mass-weighted RMSD ($\\AA$)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_analysis_alignment_and_rms_rmsd_27_1.png" src="../../../_images/examples_analysis_alignment_and_rms_rmsd_27_1.png" />
</div>
</div>
</section>
<section id="Custom-weights">
<h3>Custom weights<a class="headerlink" href="#Custom-weights" title="Permalink to this heading"></a></h3>
<p>You can also pass in an array of values for the weights. This must have the same length as the number of atoms in your selection groups. In this example, we pass in arrays of residue numbers. This <strong>is not a typical weighting you might choose</strong>, but we use it here to show how you can get different results to the previous graphs for mass-weighted and non-weighted RMSD. You could choose to pass in an array of charges, or your own custom value.</p>
<p>First we select the atom groups to make this easier.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ag</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;protein and name CA&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shape of C-alpha charges:&#39;</span><span class="p">,</span> <span class="n">ag</span><span class="o">.</span><span class="n">charges</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">core</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="n">CORE</span><span class="p">)</span>
<span class="n">lid</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="n">LID</span><span class="p">)</span>
<span class="n">nmp</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="n">NMP</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shape of C-alpha charges: (214,)
</pre></div></div>
</div>
<p>Below, we pass in weights for <code class="docutils literal notranslate"><span class="pre">ag</span></code> with the <code class="docutils literal notranslate"><span class="pre">weights</span></code> keyword, and weights for the <code class="docutils literal notranslate"><span class="pre">groupselections</span></code> with the <code class="docutils literal notranslate"><span class="pre">weights_groupselections</span></code> keyword.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R_charge</span> <span class="o">=</span> <span class="n">rms</span><span class="o">.</span><span class="n">RMSD</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span>
                    <span class="n">select</span><span class="o">=</span><span class="s1">&#39;protein and name CA&#39;</span><span class="p">,</span>
                    <span class="n">groupselections</span><span class="o">=</span><span class="p">[</span><span class="n">CORE</span><span class="p">,</span> <span class="n">LID</span><span class="p">,</span> <span class="n">NMP</span><span class="p">],</span>
                    <span class="n">weights</span><span class="o">=</span><span class="n">ag</span><span class="o">.</span><span class="n">resids</span><span class="p">,</span>
                    <span class="n">weights_groupselections</span><span class="o">=</span><span class="p">[</span><span class="n">core</span><span class="o">.</span><span class="n">resids</span><span class="p">,</span>
                                             <span class="n">lid</span><span class="o">.</span><span class="n">resids</span><span class="p">,</span>
                                             <span class="n">nmp</span><span class="o">.</span><span class="n">resids</span><span class="p">])</span>
<span class="n">R_charge</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;MDAnalysis.analysis.rms.RMSD at 0x7f2e80483490&gt;
</pre></div></div>
</div>
<p>You can see in the below graph that the NMP domain has much higher RMSD than before, as each particle is weighted by its residue number. Conversely, the CORE domain doesn’t really change much. We could potentially infer from this that residues later in the NMP domain (with a higher residue number) are mobile during the length of the trajectory, whereas residues later in the CORE domain do not seem to contribute significantly to the RMSD.</p>
<p>However, again, this is a <strong>very non-conventional metric</strong> and is shown here simply to demonstrate how to use the code.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_charge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">R_charge</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">rmsd</span><span class="p">,</span>
                         <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Frame&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;Time (ns)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;C-alphas&#39;</span><span class="p">,</span> <span class="s1">&#39;CORE&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;LID&#39;</span><span class="p">,</span> <span class="s1">&#39;NMP&#39;</span><span class="p">])</span>
<span class="n">ax_charge</span> <span class="o">=</span> <span class="n">df_charge</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Frame&#39;</span><span class="p">,</span>
                           <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C-alphas&#39;</span><span class="p">,</span> <span class="s1">&#39;CORE&#39;</span><span class="p">,</span> <span class="s1">&#39;LID&#39;</span><span class="p">,</span> <span class="s1">&#39;NMP&#39;</span><span class="p">])</span>
<span class="n">ax_charge</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Charge-weighted RMSD ($\AA$)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Charge-weighted RMSD ($\\AA$)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_analysis_alignment_and_rms_rmsd_34_1.png" src="../../../_images/examples_analysis_alignment_and_rms_rmsd_34_1.png" />
</div>
</div>
</section>
</section>
<section id="References">
<h2>References<a class="headerlink" href="#References" title="Permalink to this heading"></a></h2>
<p>[1] Oliver Beckstein, Elizabeth J. Denning, Juan R. Perilla, and Thomas B. Woolf. Zipping and Unzipping of Adenylate Kinase: Atomistic Insights into the Ensemble of Open↔Closed Transitions. Journal of Molecular Biology, 394(1):160–176, November 2009. 00107. URL: <a class="reference external" href="https://linkinghub.elsevier.com/retrieve/pii/S0022283609011164">https://linkinghub.elsevier.com/retrieve/pii/S0022283609011164</a>, doi:10.1016/j.jmb.2009.09.009.</p>
<p>[2] Richard J. Gowers, Max Linke, Jonathan Barnoud, Tyler J. E. Reddy, Manuel N. Melo, Sean L. Seyler, Jan Domański, David L. Dotson, Sébastien Buchoux, Ian M. Kenney, and Oliver Beckstein. MDAnalysis: A Python Package for the Rapid Analysis of Molecular Dynamics Simulations. Proceedings of the 15th Python in Science Conference, pages 98–105, 2016. 00152. URL: <a class="reference external" href="https://conference.scipy.org/proceedings/scipy2016/oliver_beckstein.html">https://conference.scipy.org/proceedings/scipy2016/oliver_beckstein.html</a>, doi:10.25080/Majora-629e541a-00e.</p>
<p>[3] Naveen Michaud-Agrawal, Elizabeth J. Denning, Thomas B. Woolf, and Oliver Beckstein. MDAnalysis: A toolkit for the analysis of molecular dynamics simulations. Journal of Computational Chemistry, 32(10):2319–2327, July 2011. 00778. URL: <a class="reference external" href="http://doi.wiley.com/10.1002/jcc.21787">http://doi.wiley.com/10.1002/jcc.21787</a>, doi:10.1002/jcc.21787.</p>
<p>[4] Douglas L. Theobald. Rapid calculation of RMSDs using a quaternion-based characteristic polynomial. Acta Crystallographica Section A Foundations of Crystallography, 61(4):478–480, July 2005. 00127. URL: <a class="reference external" href="http://scripts.iucr.org/cgi-bin/paper?S0108767305015266">http://scripts.iucr.org/cgi-bin/paper?S0108767305015266</a>, doi:10.1107/S0108767305015266.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="aligning_trajectory_to_frame.html" class="btn btn-neutral float-left" title="Aligning a trajectory to itself" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pairwise_rmsd.html" class="btn btn-neutral float-right" title="Calculating the pairwise RMSD of a trajectory" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2023, Lily Wang, Irfan Alibay, Patricio Barletta, Cédric Bouysset, Jan Domanski, Bjarne Feddersen, Florent Langenfeld, Hugo MacDermott-Opeskin, Micaela Matta, Rocco Meli, Paul Smith, Mieczyslaw Torchala, Mark Verma, Yuxuan Zhuang, Richard J. Gowers, and Oliver Beckstein..</p>
  </div>

  

<div class="footer"><p>Please see
    our <a href="https://www.mdanalysis.org/pages/privacy/">Privacy Policy</a>
    to learn how <a href="https://www.mdanalysis.org">MDAnalysis</a> collects data.</p>
    <script data-goatcounter="https://mdanalysis.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
    var versions_json_url = 'https://userguide.mdanalysis.org/versions.json'
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>